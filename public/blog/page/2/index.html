
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Nilenso Blog</title>
  <meta name="author" content="Nilenso">

  
  <meta name="description" content="
  
  
  
    
      
  
  
    
      Fast Sudoku Solver in Haskell #1: A Simple Solution
      
      
    
      
        










        
  ...">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1"/>
  <meta name="apple-mobile-web-app-capable" content="yes"/>

  
  <link rel="canonical" href="http://blog.nilenso.com/blog/page/2/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Nilenso Blog" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>

  <!-- Typekit fonts -->
  <script type="text/javascript" src="//use.typekit.net/xgt4lgm.js"></script>
  <script type="text/javascript">try{Typekit.load();}catch(e){}</script>

  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Fjalla+One' rel='stylesheet' type='text/css'>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-43704022-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>



</head>

<body   class="collapse-sidebar sidebar-footer" >
  <header role="banner">
</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  
</ul>
  
<header class="nilenso-header">
  <img class="header-logo-image left" src="/images/nilenso-200.png" />
  <a class="header-link logo-name" href="http://nilenso.com">nilenso</a>
  <a class="header-link right page-link rss-link" href="/atom.xml" title="subscribe via RSS"><img class="rss-link-image" src="/images/rss.png"></img></a>
  <a class="header-link page-link" href="/blog/archives">Archive</a>
  <a class="header-link page-link active" href="/">Blog</a>
</header>
<div class="clear"></div>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
  
    
      <h1 class="entry-title"><a href="/blog/2018/06/28/fast-sudoku-solver-in-haskell-1-a-simple-solution/">Fast Sudoku Solver in Haskell #1: A Simple Solution</a></h1>
      
      
    
      <p class="meta">
        









<time datetime="2018-06-28T00:00:00+05:30" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="https://en.wikipedia.org/wiki/Sudoku" target="_blank" rel="noopener">Sudoku</a> is a number placement puzzle. It consists of a 9x9 grid which is to be filled with digits from 1 to 9. Some of the cells of the grid come pre-filled and the player has to fill the rest.</p>


<p><a href="https://www.haskell.org/" target="_blank" rel="noopener">Haskell</a> is a purely functional programming language. It is a good choice to solve Sudoku given the problem’s <a href="https://en.wikipedia.org/wiki/Combinatorics" target="_blank" rel="noopener">combinatorial</a> nature. The aim of this series of posts is to write a <strong>fast</strong> Sudoku solver in Haskell. We’ll focus on both implementing the solution and making it efficient, step-by-step, starting with a slow but simple solution in this post<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p>


<!--more-->


<p>This is the first post in a series of posts:</p>


<ol type="1">
<li><a href="https://abhinavsarkar.net/posts/fast-sudoku-solver-in-haskell-1/">Fast Sudoku Solver in Haskell #1: A Simple Solution</a></li>
<li><a href="https://abhinavsarkar.net/posts/fast-sudoku-solver-in-haskell-2/">Fast Sudoku Solver in Haskell #2: A 200x Faster Solution</a></li>
<li><a href="https://abhinavsarkar.net/posts/fast-sudoku-solver-in-haskell-3/">Fast Sudoku Solver in Haskell #3: Picking the Right Data Structures</a></li>
</ol>


<p>Discuss this post on <a href="https://www.reddit.com/r/haskell/comments/8uapij/fast_sudoku_solver_in_haskell/" target="_blank" rel="noopener">r/haskell</a>.</p>


<p><nav id="toc" class="right-toc"><h3>Contents</h3><ol><li><a href="#constraint-satisfaction-problem">Constraint Satisfaction Problem</a></li><li><a href="#setting-up">Setting up</a></li><li><a href="#pruning-the-cells">Pruning the Cells</a></li><li><a href="#pruning-the-grid">Pruning the Grid</a></li><li><a href="#making-the-choice">Making the Choice</a></li><li><a href="#solving-the-puzzle">Solving the Puzzle</a></li><li><a href="#conclusion">Conclusion</a></li></ol></nav></p>

<h2 id="constraint-satisfaction-problem" data-track-content data-content-name="constraint-satisfaction-problem" data-content-piece="fast-sudoku-solver-in-haskell-1">Constraint Satisfaction Problem<a href="#constraint-satisfaction-problem" class="ref-link"></a><a href="#top" class="top-link" title="Back to top"></a></h2>


<p>Solving Sudoku is a <a href="https://en.wikipedia.org/wiki/Constraint_satisfaction_problem" target="_blank" rel="noopener">constraint satisfaction problem</a>. We are given a partially filled grid which we have to fill completely such that each of the following constraints are satisfied:</p>


<ol type="1">
<li>Each of the nine rows must have all the digits, from 1 to 9.</li>
<li>Each of the nine columns must have all the digits, from 1 to 9.</li>
<li>Each of the nine 3x3 sub-grids must have all the digits, from 1 to 9.</li>
</ol>


<pre class="plain low-line-height"><code>+-------+-------+-------+
| . . . | . . . | . 1 . |
| 4 . . | . . . | . . . |
| . 2 . | . . . | . . . |
+-------+-------+-------+
| . . . | . 5 . | 4 . 7 |
| . . 8 | . . . | 3 . . |
| . . 1 | . 9 . | . . . |
+-------+-------+-------+
| 3 . . | 4 . . | 2 . . |
| . 5 . | 1 . . | . . . |
| . . . | 8 . 6 | . . . |
+-------+-------+-------+
    A sample puzzle

+-------+-------+-------+
| 6 9 3 | 7 8 4 | 5 1 2 |
| 4 8 7 | 5 1 2 | 9 3 6 |
| 1 2 5 | 9 6 3 | 8 7 4 |
+-------+-------+-------+
| 9 3 2 | 6 5 1 | 4 8 7 |
| 5 6 8 | 2 4 7 | 3 9 1 |
| 7 4 1 | 3 9 8 | 6 2 5 |
+-------+-------+-------+
| 3 1 9 | 4 7 5 | 2 6 8 |
| 8 5 6 | 1 2 9 | 7 4 3 |
| 2 7 4 | 8 3 6 | 1 5 9 |
+-------+-------+-------+
    and its solution</code></pre>


<p>Each cell in the grid is member of one row, one column and one sub-grid (called <em>block</em> in general). Digits in the pre-filled cells impose constraints on the rows, columns, and sub-grids they are part of. For example, if a cell contains <code>1</code> then no other cell in that cell’s row, column or sub-grid can contain <code>1</code>. Given these constraints, we can devise a simple algorithm to solve Sudoku:</p>


<ol type="1">
<li>Each cell contains either a single digit or has a set of possible digits. For example, a grid showing the possibilities of all non-filled cells for the sample puzzle above:</li>
</ol>


<pre class="small plain low-line-height overflow"><code>+-------------------------------------+-------------------------------------+-------------------------------------+
| [123456789] [123456789] [123456789] | [123456789] [123456789] [123456789] | [123456789] 1           [123456789] |
| 4           [123456789] [123456789] | [123456789] [123456789] [123456789] | [123456789] [123456789] [123456789] |
| [123456789] 2           [123456789] | [123456789] [123456789] [123456789] | [123456789] [123456789] [123456789] |
+-------------------------------------+-------------------------------------+-------------------------------------+
| [123456789] [123456789] [123456789] | [123456789] 5           [123456789] | 4           [123456789] 7           |
| [123456789] [123456789] 8           | [123456789] [123456789] [123456789] | 3           [123456789] [123456789] |
| [123456789] [123456789] 1           | [123456789] 9           [123456789] | [123456789] [123456789] [123456789] |
+-------------------------------------+-------------------------------------+-------------------------------------+
| 3           [123456789] [123456789] | 4           [123456789] [123456789] | 2           [123456789] [123456789] |
| [123456789] 5           [123456789] | 1           [123456789] [123456789] | [123456789] [123456789] [123456789] |
| [123456789] [123456789] [123456789] | 8           [123456789] 6           | [123456789] [123456789] [123456789] |
+-------------------------------------+-------------------------------------+-------------------------------------+</code></pre>


<ol start="2" type="1">
<li>If a cell contains a digit, remove that digit from the list of the possible digits from all its neighboring cells. Neighboring cells are the other cells in the given cell’s row, column and sub-grid. For example, the grid after removing the fixed value <code>4</code> of the row-2-column-1 cell from its neighboring cells:</li>
</ol>


<pre class="small plain low-line-height overflow"><code>+-------------------------------------+-------------------------------------+-------------------------------------+
| [123 56789] [123 56789] [123 56789] | [123456789] [123456789] [123456789] | [123456789] 1           [123456789] |
| 4           [123 56789] [123 56789] | [123 56789] [123 56789] [123 56789] | [123 56789] [123 56789] [123 56789] |
| [123 56789] 2           [123 56789] | [123456789] [123456789] [123456789] | [123456789] [123456789] [123456789] |
+-------------------------------------+-------------------------------------+-------------------------------------+
| [123 56789] [123456789] [123456789] | [123456789] 5           [123456789] | 4           [123456789] 7           |
| [123 56789] [123456789] 8           | [123456789] [123456789] [123456789] | 3           [123456789] [123456789] |
| [123 56789] [123456789] 1           | [123456789] 9           [123456789] | [123456789] [123456789] [123456789] |
+-------------------------------------+-------------------------------------+-------------------------------------+
| 3           [123456789] [123456789] | 4           [123456789] [123456789] | 2           [123456789] [123456789] |
| [123 56789] 5           [123456789] | 1           [123456789] [123456789] | [123456789] [123456789] [123456789] |
| [123 56789] [123456789] [123456789] | 8           [123456789] 6           | [123456789] [123456789] [123456789] |
+-------------------------------------+-------------------------------------+-------------------------------------+</code></pre>


<ol start="3" type="1">
<li>Repeat the previous step for all the cells that are have been solved (or <em>fixed</em>), either pre-filled or filled in the previous iteration of the solution. For example, the grid after removing all fixed values from all non-fixed cells:</li>
</ol>


<pre class="small plain low-line-height overflow"><code>+-------------------------------------+-------------------------------------+-------------------------------------+
| [    56789] [  3  6789] [  3 567 9] | [ 23 567 9] [ 234 678 ] [ 2345 789] | [    56789] 1           [ 23456 89] |
| 4           [1 3  6789] [  3 567 9] | [ 23 567 9] [123  678 ] [123 5 789] | [    56789] [ 23 56789] [ 23 56 89] |
| [1   56789] 2           [  3 567 9] | [  3 567 9] [1 34 678 ] [1 345 789] | [    56789] [  3456789] [  3456 89] |
+-------------------------------------+-------------------------------------+-------------------------------------+
| [ 2   6  9] [  3  6  9] [ 23  6  9] | [ 23  6   ] 5           [123    8 ] | 4           [ 2   6 89] 7           |
| [ 2  567 9] [   4 67 9] 8           | [ 2   67  ] [12 4 67  ] [12 4  7  ] | 3           [ 2  56  9] [12  56  9] |
| [ 2  567  ] [  34 67  ] 1           | [ 23  67  ] 9           [ 234  78 ] | [    56 8 ] [ 2  56 8 ] [ 2  56 8 ] |
+-------------------------------------+-------------------------------------+-------------------------------------+
| 3           [1    6789] [     67 9] | 4           7           [    5 7 9] | 2           [    56789] [1   56 89] |
| [ 2   6789] 5           [ 2 4 67 9] | 1           [ 23   7  ] [ 23   7 9] | [     6789] [  34 6789] [  34 6 89] |
| [12    7 9] [1  4  7 9] [ 2 4  7 9] | 8           [ 23   7  ] 6           | [1   5 7 9] [  345 7 9] [1 345   9] |
+-------------------------------------+-------------------------------------+-------------------------------------+</code></pre>


<ol start="4" type="1">
<li>Continue till the grid <em>settles</em>, that is, there are no more changes in the possibilities of any cells. For example, the settled grid for the current iteration:</li>
</ol>


<pre class="small plain low-line-height overflow"><code>+-------------------------------------+-------------------------------------+-------------------------------------+
| [    56789] [  3  6789] [  3 567 9] | [ 23 567 9] [ 234 6 8 ] [ 2345 789] | [    56789] 1           [ 23456 89] |
| 4           [1 3  6789] [  3 567 9] | [ 23 567 9] [123  6 8 ] [123 5 789] | [    56789] [ 23 56789] [ 23 56 89] |
| [1   56789] 2           [  3 567 9] | [  3 567 9] [1 34 6 8 ] [1 345 789] | [    56789] [  3456789] [  3456 89] |
+-------------------------------------+-------------------------------------+-------------------------------------+
| [ 2   6  9] [  3  6  9] [ 23  6  9] | [ 23  6   ] 5           [123    8 ] | 4           [ 2   6 89] 7           |
| [ 2  567 9] [   4 67 9] 8           | [ 2   67  ] [12 4 6   ] [12 4  7  ] | 3           [ 2  56  9] [12  56  9] |
| [ 2  567  ] [  34 67  ] 1           | [ 23  67  ] 9           [ 234  78 ] | [    56 8 ] [ 2  56 8 ] [ 2  56 8 ] |
+-------------------------------------+-------------------------------------+-------------------------------------+
| 3           [1    6 89] [     6  9] | 4           7           [    5   9] | 2           [    56 89] [1   56 89] |
| [ 2   6789] 5           [ 2 4 67 9] | 1           [ 23      ] [ 23     9] | [     6789] [  34 6789] [  34 6 89] |
| [12    7 9] [1  4  7 9] [ 2 4  7 9] | 8           [ 23      ] 6           | [1   5 7 9] [  345 7 9] [1 345   9] |
+-------------------------------------+-------------------------------------+-------------------------------------+</code></pre>


<ol start="5" type="1">
<li>Once the grid settles, choose one of the non-fixed cells following some strategy. Select one of the digits from all the possibilities of the cell, and fix (assume) the cell to have that digit. Go back to step 1 and repeat.</li>
<li>The elimination of possibilities may result in inconsistencies. For example, you may end up with a cell with no possibilities. In such a case, discard that branch of solution, and backtrack to last point where you fixed a cell. Choose a different possibility to fix and repeat.</li>
<li>If at any point the grid is completely filled, you’ve found the solution!</li>
<li>If you exhaust all branches of the solution then the puzzle is unsolvable. This can happen if it starts with cells pre-filled wrongly.</li>
</ol>


<p>This algorithm is actually a <a href="https://en.wikipedia.org/wiki/Depth-first_search" target="_blank" rel="noopener">Depth-First Search</a> on the <a href="https://en.wikipedia.org/wiki/State_space_search" target="_blank" rel="noopener">state space</a> of the grid configurations. It guarantees to either find a solution or prove a puzzle to be unsolvable.</p>


<h2 id="setting-up" data-track-content data-content-name="setting-up" data-content-piece="fast-sudoku-solver-in-haskell-1">Setting up<a href="#setting-up" class="ref-link"></a><a href="#top" class="top-link" title="Back to top"></a></h2>


<p>We start with writing types to represent the cells and the grid:</p>


<div class="sourceCode" id="cb6"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">data</span> <span class="dt">Cell</span> <span class="ot">=</span> <span class="dt">Fixed</span> <span class="dt">Int</span> <span class="op">|</span> <span class="dt">Possible</span> [<span class="dt">Int</span>] <span class="kw">deriving</span> (<span class="dt">Show</span>, <span class="dt">Eq</span>)</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="kw">type</span> <span class="dt">Row</span>  <span class="ot">=</span> [<span class="dt">Cell</span>]</span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="kw">type</span> <span class="dt">Grid</span> <span class="ot">=</span> [<span class="dt">Row</span>]</span></code></pre></div>


<p>A cell is either fixed with a particular digit or has a set of digits as possibilities. So it is natural to represent it as a <a href="https://en.wikipedia.org/wiki/Algebraic_data_type" target="_blank" rel="noopener">sum type</a> with <code>Fixed</code> and <code>Possible</code> constructors. A row is a list of cells and a grid is a list of rows.</p>


<p>We’ll take the input puzzle as a string of 81 characters representing the cells, left-to-right and top-to-bottom. An example is:</p>


<pre class="plain"><code>.......1.4.........2...........5.4.7..8...3....1.9....3..4..2...5.1........8.6...</code></pre>


<p>Here, <code>.</code> represents an non-filled cell. Let’s write a function to read this input and parse it to our <code>Grid</code> data structure:</p>


<div class="sourceCode" id="cb8"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb8-1"><a href="#cb8-1"></a><span class="ot">readGrid ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Maybe</span> <span class="dt">Grid</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>readGrid s</span>
<span id="cb8-3"><a href="#cb8-3"></a>  <span class="op">|</span> <span class="fu">length</span> s <span class="op">==</span> <span class="dv">81</span> <span class="ot">=</span> <span class="fu">traverse</span> (<span class="fu">traverse</span> readCell) <span class="op">.</span> Data.List.Split.chunksOf <span class="dv">9</span> <span class="op">$</span> s</span>
<span id="cb8-4"><a href="#cb8-4"></a>  <span class="op">|</span> <span class="fu">otherwise</span>      <span class="ot">=</span> <span class="dt">Nothing</span></span>
<span id="cb8-5"><a href="#cb8-5"></a>  <span class="kw">where</span></span>
<span id="cb8-6"><a href="#cb8-6"></a>    readCell <span class="ch">'.'</span> <span class="ot">=</span> <span class="dt">Just</span> <span class="op">$</span> <span class="dt">Possible</span> [<span class="dv">1</span><span class="op">..</span><span class="dv">9</span>]</span>
<span id="cb8-7"><a href="#cb8-7"></a>    readCell c</span>
<span id="cb8-8"><a href="#cb8-8"></a>      <span class="op">|</span> Data.Char.isDigit c <span class="op">&amp;&amp;</span> c <span class="op">&gt;</span> <span class="ch">'0'</span> <span class="ot">=</span> <span class="dt">Just</span> <span class="op">.</span> <span class="dt">Fixed</span> <span class="op">.</span> Data.Char.digitToInt <span class="op">$</span> c</span>
<span id="cb8-9"><a href="#cb8-9"></a>      <span class="op">|</span> <span class="fu">otherwise</span> <span class="ot">=</span> <span class="dt">Nothing</span></span></code></pre></div>


<p><code>readGrid</code> return a <code>Just grid</code> if the input is correct, else it returns a <code>Nothing</code>. It parses a <code>.</code> to a <code>Possible</code> cell with all digits as possibilities, and a digit char to a <code>Fixed</code> cell with that digit. Let’s try it out in the <em>REPL</em>:</p>


<div class="sourceCode" id="cb9"><pre class="sourceCode small haskell"><code class="sourceCode haskell"><span id="cb9-1"><a href="#cb9-1"></a><span class="op">*</span><span class="dt">Main</span><span class="op">&gt;</span> <span class="dt">Just</span> grid <span class="ot">=</span> readGrid <span class="st">&quot;.......1.4.........2...........5.4.7..8...3....1.9....3..4..2...5.1........8.6...&quot;</span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="op">*</span><span class="dt">Main</span><span class="op">&gt;</span> <span class="fu">mapM_</span> <span class="fu">print</span> grid</span>
<span id="cb9-3"><a href="#cb9-3"></a>[<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Fixed</span> <span class="dv">1</span>,<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>]]</span>
<span id="cb9-4"><a href="#cb9-4"></a>[<span class="dt">Fixed</span> <span class="dv">4</span>,<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>]]</span>
<span id="cb9-5"><a href="#cb9-5"></a>[<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Fixed</span> <span class="dv">2</span>,<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>]]</span>
<span id="cb9-6"><a href="#cb9-6"></a>[<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Fixed</span> <span class="dv">5</span>,<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Fixed</span> <span class="dv">4</span>,<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Fixed</span> <span class="dv">7</span>]</span>
<span id="cb9-7"><a href="#cb9-7"></a>[<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Fixed</span> <span class="dv">8</span>,<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Fixed</span> <span class="dv">3</span>,<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>]]</span>
<span id="cb9-8"><a href="#cb9-8"></a>[<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Fixed</span> <span class="dv">1</span>,<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Fixed</span> <span class="dv">9</span>,<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>]]</span>
<span id="cb9-9"><a href="#cb9-9"></a>[<span class="dt">Fixed</span> <span class="dv">3</span>,<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Fixed</span> <span class="dv">4</span>,<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Fixed</span> <span class="dv">2</span>,<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>]]</span>
<span id="cb9-10"><a href="#cb9-10"></a>[<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Fixed</span> <span class="dv">5</span>,<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Fixed</span> <span class="dv">1</span>,<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>]]</span>
<span id="cb9-11"><a href="#cb9-11"></a>[<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Fixed</span> <span class="dv">8</span>,<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Fixed</span> <span class="dv">6</span>,<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>],<span class="dt">Possible</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>]]</span></code></pre></div>


<p>The output is a bit unreadable but correct. We can write a few functions to clean it up:</p>


<div class="sourceCode" id="cb10"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb10-1"><a href="#cb10-1"></a><span class="ot">showGrid ::</span> <span class="dt">Grid</span> <span class="ot">-&gt;</span> <span class="dt">String</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>showGrid <span class="ot">=</span> <span class="fu">unlines</span> <span class="op">.</span> <span class="fu">map</span> (<span class="fu">unwords</span> <span class="op">.</span> <span class="fu">map</span> showCell)</span>
<span id="cb10-3"><a href="#cb10-3"></a>  <span class="kw">where</span></span>
<span id="cb10-4"><a href="#cb10-4"></a>    showCell (<span class="dt">Fixed</span> x) <span class="ot">=</span> <span class="fu">show</span> x</span>
<span id="cb10-5"><a href="#cb10-5"></a>    showCell _ <span class="ot">=</span> <span class="st">&quot;.&quot;</span></span>
<span id="cb10-6"><a href="#cb10-6"></a></span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="ot">showGridWithPossibilities ::</span> <span class="dt">Grid</span> <span class="ot">-&gt;</span> <span class="dt">String</span></span>
<span id="cb10-8"><a href="#cb10-8"></a>showGridWithPossibilities <span class="ot">=</span> <span class="fu">unlines</span> <span class="op">.</span> <span class="fu">map</span> (<span class="fu">unwords</span> <span class="op">.</span> <span class="fu">map</span> showCell)</span>
<span id="cb10-9"><a href="#cb10-9"></a>  <span class="kw">where</span></span>
<span id="cb10-10"><a href="#cb10-10"></a>    showCell (<span class="dt">Fixed</span> x)     <span class="ot">=</span> <span class="fu">show</span> x <span class="op">++</span> <span class="st">&quot;          &quot;</span></span>
<span id="cb10-11"><a href="#cb10-11"></a>    showCell (<span class="dt">Possible</span> xs) <span class="ot">=</span></span>
<span id="cb10-12"><a href="#cb10-12"></a>      (<span class="op">++</span> <span class="st">&quot;]&quot;</span>)</span>
<span id="cb10-13"><a href="#cb10-13"></a>      <span class="op">.</span> Data.List.foldl' (\acc x <span class="ot">-&gt;</span> acc <span class="op">++</span> <span class="kw">if</span> x <span class="ot">`elem`</span> xs <span class="kw">then</span> <span class="fu">show</span> x <span class="kw">else</span> <span class="st">&quot; &quot;</span>) <span class="st">&quot;[&quot;</span></span>
<span id="cb10-14"><a href="#cb10-14"></a>      <span class="op">$</span> [<span class="dv">1</span><span class="op">..</span><span class="dv">9</span>]</span></code></pre></div>


<p>Back to the <em>REPL</em> again:</p>


<div class="sourceCode" id="cb11"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb11-1"><a href="#cb11-1"></a><span class="op">*</span><span class="dt">Main</span><span class="op">&gt;</span> <span class="dt">Just</span> grid <span class="ot">=</span> readGrid <span class="st">&quot;.......1.4.........2...........5.4.7..8...3....1.9....3..4..2...5.1........8.6...&quot;</span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="op">*</span><span class="dt">Main</span><span class="op">&gt;</span> <span class="fu">putStrLn</span> <span class="op">$</span> showGrid grid</span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="dv">1</span> <span class="op">.</span></span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="dv">4</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span></span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="op">.</span> <span class="dv">2</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span></span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="dv">5</span> <span class="op">.</span> <span class="dv">4</span> <span class="op">.</span> <span class="dv">7</span></span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="op">.</span> <span class="op">.</span> <span class="dv">8</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="dv">3</span> <span class="op">.</span> <span class="op">.</span></span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="op">.</span> <span class="op">.</span> <span class="dv">1</span> <span class="op">.</span> <span class="dv">9</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span></span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="dv">3</span> <span class="op">.</span> <span class="op">.</span> <span class="dv">4</span> <span class="op">.</span> <span class="op">.</span> <span class="dv">2</span> <span class="op">.</span> <span class="op">.</span></span>
<span id="cb11-10"><a href="#cb11-10"></a><span class="op">.</span> <span class="dv">5</span> <span class="op">.</span> <span class="dv">1</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span></span>
<span id="cb11-11"><a href="#cb11-11"></a><span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="dv">8</span> <span class="op">.</span> <span class="dv">6</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span></span></code></pre></div>


<div class="sourceCode" id="cb12"><pre class="sourceCode small haskell"><code class="sourceCode haskell"><span id="cb12-1"><a href="#cb12-1"></a><span class="op">*</span><span class="dt">Main</span><span class="op">&gt;</span> <span class="fu">putStrLn</span> <span class="op">$</span> showGridWithPossibilities grid</span>
<span id="cb12-2"><a href="#cb12-2"></a>[<span class="dv">123456789</span>] [<span class="dv">123456789</span>] [<span class="dv">123456789</span>] [<span class="dv">123456789</span>] [<span class="dv">123456789</span>] [<span class="dv">123456789</span>] [<span class="dv">123456789</span>] <span class="dv">1</span>           [<span class="dv">123456789</span>]</span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="dv">4</span>           [<span class="dv">123456789</span>] [<span class="dv">123456789</span>] [<span class="dv">123456789</span>] [<span class="dv">123456789</span>] [<span class="dv">123456789</span>] [<span class="dv">123456789</span>] [<span class="dv">123456789</span>] [<span class="dv">123456789</span>]</span>
<span id="cb12-4"><a href="#cb12-4"></a>[<span class="dv">123456789</span>] <span class="dv">2</span>           [<span class="dv">123456789</span>] [<span class="dv">123456789</span>] [<span class="dv">123456789</span>] [<span class="dv">123456789</span>] [<span class="dv">123456789</span>] [<span class="dv">123456789</span>] [<span class="dv">123456789</span>]</span>
<span id="cb12-5"><a href="#cb12-5"></a>[<span class="dv">123456789</span>] [<span class="dv">123456789</span>] [<span class="dv">123456789</span>] [<span class="dv">123456789</span>] <span class="dv">5</span>           [<span class="dv">123456789</span>] <span class="dv">4</span>           [<span class="dv">123456789</span>] <span class="dv">7</span></span>
<span id="cb12-6"><a href="#cb12-6"></a>[<span class="dv">123456789</span>] [<span class="dv">123456789</span>] <span class="dv">8</span>           [<span class="dv">123456789</span>] [<span class="dv">123456789</span>] [<span class="dv">123456789</span>] <span class="dv">3</span>           [<span class="dv">123456789</span>] [<span class="dv">123456789</span>]</span>
<span id="cb12-7"><a href="#cb12-7"></a>[<span class="dv">123456789</span>] [<span class="dv">123456789</span>] <span class="dv">1</span>           [<span class="dv">123456789</span>] <span class="dv">9</span>           [<span class="dv">123456789</span>] [<span class="dv">123456789</span>] [<span class="dv">123456789</span>] [<span class="dv">123456789</span>]</span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="dv">3</span>           [<span class="dv">123456789</span>] [<span class="dv">123456789</span>] <span class="dv">4</span>           [<span class="dv">123456789</span>] [<span class="dv">123456789</span>] <span class="dv">2</span>           [<span class="dv">123456789</span>] [<span class="dv">123456789</span>]</span>
<span id="cb12-9"><a href="#cb12-9"></a>[<span class="dv">123456789</span>] <span class="dv">5</span>           [<span class="dv">123456789</span>] <span class="dv">1</span>           [<span class="dv">123456789</span>] [<span class="dv">123456789</span>] [<span class="dv">123456789</span>] [<span class="dv">123456789</span>] [<span class="dv">123456789</span>]</span>
<span id="cb12-10"><a href="#cb12-10"></a>[<span class="dv">123456789</span>] [<span class="dv">123456789</span>] [<span class="dv">123456789</span>] <span class="dv">8</span>           [<span class="dv">123456789</span>] <span class="dv">6</span>           [<span class="dv">123456789</span>] [<span class="dv">123456789</span>] [<span class="dv">123456789</span>]</span></code></pre></div>


<p>The output is more readable now. We see that, at the start, all the non-filled cells have all the digits as possible values. We’ll use these functions for debugging as we go forward. We can now start solving the puzzle.</p>


<div class="page-break">

</div>


<h2 id="pruning-the-cells" data-track-content data-content-name="pruning-the-cells" data-content-piece="fast-sudoku-solver-in-haskell-1">Pruning the Cells<a href="#pruning-the-cells" class="ref-link"></a><a href="#top" class="top-link" title="Back to top"></a></h2>


<p>We can remove the digits of fixed cells from their neighboring cells, one cell as a time. But, it is faster to find all the fixed digits in a row of cells and remove them from the possibilities of all the non-fixed cells of the row, at once. Then we can repeat this <em>pruning</em> step for all the rows of the grid (and columns and sub-grids too! We’ll see how).</p>


<div class="sourceCode" id="cb13"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb13-1"><a href="#cb13-1"></a><span class="ot">pruneCells ::</span> [<span class="dt">Cell</span>] <span class="ot">-&gt;</span> <span class="dt">Maybe</span> [<span class="dt">Cell</span>]</span>
<span id="cb13-2"><a href="#cb13-2"></a>pruneCells cells <span class="ot">=</span> <span class="fu">traverse</span> pruneCell cells</span>
<span id="cb13-3"><a href="#cb13-3"></a>  <span class="kw">where</span></span>
<span id="cb13-4"><a href="#cb13-4"></a>    fixeds <span class="ot">=</span> [x <span class="op">|</span> <span class="dt">Fixed</span> x <span class="ot">&lt;-</span> cells]</span>
<span id="cb13-5"><a href="#cb13-5"></a></span>
<span id="cb13-6"><a href="#cb13-6"></a>    pruneCell (<span class="dt">Possible</span> xs) <span class="ot">=</span> <span class="kw">case</span> xs <span class="dt">Data.List</span><span class="op">.</span>\\ fixeds <span class="kw">of</span></span>
<span id="cb13-7"><a href="#cb13-7"></a>      []  <span class="ot">-&gt;</span> <span class="dt">Nothing</span></span>
<span id="cb13-8"><a href="#cb13-8"></a>      [y] <span class="ot">-&gt;</span> <span class="dt">Just</span> <span class="op">$</span> <span class="dt">Fixed</span> y</span>
<span id="cb13-9"><a href="#cb13-9"></a>      ys  <span class="ot">-&gt;</span> <span class="dt">Just</span> <span class="op">$</span> <span class="dt">Possible</span> ys</span>
<span id="cb13-10"><a href="#cb13-10"></a>    pruneCell x <span class="ot">=</span> <span class="dt">Just</span> x</span></code></pre></div>


<p><code>pruneCells</code> prunes a list of cells as described before. We start with finding the fixed digits in the list of cells. Then we go over each non-fixed cells, removing the fixed digits we found, from their possible values. Two special cases arise:</p>


<ul>
<li>If pruning results in a cell with no possible digits, it is a sign that this branch of search has no solution and hence, we return a <code>Nothing</code> in that case.</li>
<li>If only one possible digit remains after pruning, then we turn that cell into a fixed cell with that digit.</li>
</ul>


<p>We use the <a href="https://hackage.haskell.org/package/base-4.11.1.0/docs/Data-Traversable.html#v:traverse" target="_blank" rel="noopener"><code>traverse</code></a> function for pruning the cells so that a <code>Nothing</code> resulting from pruning one cell propagates to the entire list.</p>


<p>Let’s take it for a spin in the <em>REPL</em>:</p>


<div class="sourceCode" id="cb14"><pre class="sourceCode small haskell overflow"><code class="sourceCode haskell"><span id="cb14-1"><a href="#cb14-1"></a><span class="op">*</span><span class="dt">Main</span><span class="op">&gt;</span> <span class="dt">Just</span> grid <span class="ot">=</span> readGrid <span class="st">&quot;6......1.4.........2...........5.4.7..8...3....1.9....3..4..2...5.1........8.6...&quot;</span></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="op">*</span><span class="dt">Main</span><span class="op">&gt;</span> <span class="fu">putStr</span> <span class="op">$</span> showGridWithPossibilities <span class="op">$</span> [<span class="fu">head</span> grid] <span class="co">-- first row of the grid</span></span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="dv">6</span>           [<span class="dv">123456789</span>] [<span class="dv">123456789</span>] [<span class="dv">123456789</span>] [<span class="dv">123456789</span>] [<span class="dv">123456789</span>] [<span class="dv">123456789</span>] <span class="dv">1</span>           [<span class="dv">123456789</span>]</span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="op">*</span><span class="dt">Main</span><span class="op">&gt;</span> <span class="fu">putStr</span> <span class="op">$</span> showGridWithPossibilities [fromJust <span class="op">$</span> pruneCells <span class="op">$</span> <span class="fu">head</span> grid] <span class="co">-- same row after pruning</span></span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="dv">6</span>           [ <span class="dv">2345</span> <span class="dv">789</span>] [ <span class="dv">2345</span> <span class="dv">789</span>] [ <span class="dv">2345</span> <span class="dv">789</span>] [ <span class="dv">2345</span> <span class="dv">789</span>] [ <span class="dv">2345</span> <span class="dv">789</span>] [ <span class="dv">2345</span> <span class="dv">789</span>] <span class="dv">1</span>           [ <span class="dv">2345</span> <span class="dv">789</span>]</span></code></pre></div>


<p>It works! <code>6</code> and <code>1</code> are removed from the possibilities of the other cells. Now we are ready for …</p>


<h2 id="pruning-the-grid" data-track-content data-content-name="pruning-the-grid" data-content-piece="fast-sudoku-solver-in-haskell-1">Pruning the Grid<a href="#pruning-the-grid" class="ref-link"></a><a href="#top" class="top-link" title="Back to top"></a></h2>


<p>Pruning a grid requires us to prune each row, each column and each sub-grid. Let’s try to solve it in the <em>REPL</em> first:</p>


<div class="sourceCode" id="cb15"><pre class="sourceCode small haskell overflow"><code class="sourceCode haskell"><span id="cb15-1"><a href="#cb15-1"></a><span class="op">*</span><span class="dt">Main</span><span class="op">&gt;</span> <span class="dt">Just</span> grid <span class="ot">=</span> readGrid <span class="st">&quot;6......1.4.........2...........5.4.7..8...3....1.9....3..4..2...5.1........8.6...&quot;</span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="op">*</span><span class="dt">Main</span><span class="op">&gt;</span> <span class="dt">Just</span> grid' <span class="ot">=</span> <span class="fu">traverse</span> pruneCells grid</span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="op">*</span><span class="dt">Main</span><span class="op">&gt;</span> <span class="fu">putStr</span> <span class="op">$</span> showGridWithPossibilities grid'</span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="dv">6</span>           [ <span class="dv">2345</span> <span class="dv">789</span>] [ <span class="dv">2345</span> <span class="dv">789</span>] [ <span class="dv">2345</span> <span class="dv">789</span>] [ <span class="dv">2345</span> <span class="dv">789</span>] [ <span class="dv">2345</span> <span class="dv">789</span>] [ <span class="dv">2345</span> <span class="dv">789</span>] <span class="dv">1</span>           [ <span class="dv">2345</span> <span class="dv">789</span>]</span>
<span id="cb15-5"><a href="#cb15-5"></a><span class="dv">4</span>           [<span class="dv">123</span> <span class="dv">56789</span>] [<span class="dv">123</span> <span class="dv">56789</span>] [<span class="dv">123</span> <span class="dv">56789</span>] [<span class="dv">123</span> <span class="dv">56789</span>] [<span class="dv">123</span> <span class="dv">56789</span>] [<span class="dv">123</span> <span class="dv">56789</span>] [<span class="dv">123</span> <span class="dv">56789</span>] [<span class="dv">123</span> <span class="dv">56789</span>]</span>
<span id="cb15-6"><a href="#cb15-6"></a>[<span class="dv">1</span> <span class="dv">3456789</span>] <span class="dv">2</span>           [<span class="dv">1</span> <span class="dv">3456789</span>] [<span class="dv">1</span> <span class="dv">3456789</span>] [<span class="dv">1</span> <span class="dv">3456789</span>] [<span class="dv">1</span> <span class="dv">3456789</span>] [<span class="dv">1</span> <span class="dv">3456789</span>] [<span class="dv">1</span> <span class="dv">3456789</span>] [<span class="dv">1</span> <span class="dv">3456789</span>]</span>
<span id="cb15-7"><a href="#cb15-7"></a>[<span class="dv">123</span>  <span class="dv">6</span> <span class="dv">89</span>] [<span class="dv">123</span>  <span class="dv">6</span> <span class="dv">89</span>] [<span class="dv">123</span>  <span class="dv">6</span> <span class="dv">89</span>] [<span class="dv">123</span>  <span class="dv">6</span> <span class="dv">89</span>] <span class="dv">5</span>           [<span class="dv">123</span>  <span class="dv">6</span> <span class="dv">89</span>] <span class="dv">4</span>           [<span class="dv">123</span>  <span class="dv">6</span> <span class="dv">89</span>] <span class="dv">7</span></span>
<span id="cb15-8"><a href="#cb15-8"></a>[<span class="dv">12</span> <span class="dv">4567</span> <span class="dv">9</span>] [<span class="dv">12</span> <span class="dv">4567</span> <span class="dv">9</span>] <span class="dv">8</span>           [<span class="dv">12</span> <span class="dv">4567</span> <span class="dv">9</span>] [<span class="dv">12</span> <span class="dv">4567</span> <span class="dv">9</span>] [<span class="dv">12</span> <span class="dv">4567</span> <span class="dv">9</span>] <span class="dv">3</span>           [<span class="dv">12</span> <span class="dv">4567</span> <span class="dv">9</span>] [<span class="dv">12</span> <span class="dv">4567</span> <span class="dv">9</span>]</span>
<span id="cb15-9"><a href="#cb15-9"></a>[ <span class="dv">2345678</span> ] [ <span class="dv">2345678</span> ] <span class="dv">1</span>           [ <span class="dv">2345678</span> ] <span class="dv">9</span>           [ <span class="dv">2345678</span> ] [ <span class="dv">2345678</span> ] [ <span class="dv">2345678</span> ] [ <span class="dv">2345678</span> ]</span>
<span id="cb15-10"><a href="#cb15-10"></a><span class="dv">3</span>           [<span class="dv">1</span>   <span class="dv">56789</span>] [<span class="dv">1</span>   <span class="dv">56789</span>] <span class="dv">4</span>           [<span class="dv">1</span>   <span class="dv">56789</span>] [<span class="dv">1</span>   <span class="dv">56789</span>] <span class="dv">2</span>           [<span class="dv">1</span>   <span class="dv">56789</span>] [<span class="dv">1</span>   <span class="dv">56789</span>]</span>
<span id="cb15-11"><a href="#cb15-11"></a>[ <span class="dv">234</span> <span class="dv">6789</span>] <span class="dv">5</span>           [ <span class="dv">234</span> <span class="dv">6789</span>] <span class="dv">1</span>           [ <span class="dv">234</span> <span class="dv">6789</span>] [ <span class="dv">234</span> <span class="dv">6789</span>] [ <span class="dv">234</span> <span class="dv">6789</span>] [ <span class="dv">234</span> <span class="dv">6789</span>] [ <span class="dv">234</span> <span class="dv">6789</span>]</span>
<span id="cb15-12"><a href="#cb15-12"></a>[<span class="dv">12345</span> <span class="dv">7</span> <span class="dv">9</span>] [<span class="dv">12345</span> <span class="dv">7</span> <span class="dv">9</span>] [<span class="dv">12345</span> <span class="dv">7</span> <span class="dv">9</span>] <span class="dv">8</span>           [<span class="dv">12345</span> <span class="dv">7</span> <span class="dv">9</span>] <span class="dv">6</span>           [<span class="dv">12345</span> <span class="dv">7</span> <span class="dv">9</span>] [<span class="dv">12345</span> <span class="dv">7</span> <span class="dv">9</span>] [<span class="dv">12345</span> <span class="dv">7</span> <span class="dv">9</span>]</span></code></pre></div>


<p>By <code>traverse</code>-ing the grid with <code>pruneCells</code>, we are able to prune each row, one-by-one. Since pruning a row doesn’t affect another row, we don’t have to pass the resulting rows between each pruning step. That is to say, <code>traverse</code> is enough for us, we don’t need <a href="https://hackage.haskell.org/package/base-4.11.1.0/docs/Data-Foldable.html#v:foldl" target="_blank" rel="noopener"><code>foldl</code></a> here.</p>


<p>How do we do the same thing for columns now? Since our representation for the grid is rows-first, we first need to convert it to a columns-first representation. Luckily, that’s what <a href="https://hackage.haskell.org/package/base-4.11.1.0/docs/Data-List.html#v:transpose" target="_blank" rel="noopener"><code>Data.List.transpose</code></a> function does:</p>


<div class="sourceCode" id="cb16"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb16-1"><a href="#cb16-1"></a><span class="op">*</span><span class="dt">Main</span><span class="op">&gt;</span> <span class="dt">Just</span> grid <span class="ot">=</span> readGrid <span class="st">&quot;693784512487512936125963874932651487568247391741398625319475268856129743274836159&quot;</span></span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="op">*</span><span class="dt">Main</span><span class="op">&gt;</span> <span class="fu">putStr</span> <span class="op">$</span> showGrid grid</span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="dv">6</span> <span class="dv">9</span> <span class="dv">3</span> <span class="dv">7</span> <span class="dv">8</span> <span class="dv">4</span> <span class="dv">5</span> <span class="dv">1</span> <span class="dv">2</span></span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="dv">4</span> <span class="dv">8</span> <span class="dv">7</span> <span class="dv">5</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">9</span> <span class="dv">3</span> <span class="dv">6</span></span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="dv">1</span> <span class="dv">2</span> <span class="dv">5</span> <span class="dv">9</span> <span class="dv">6</span> <span class="dv">3</span> <span class="dv">8</span> <span class="dv">7</span> <span class="dv">4</span></span>
<span id="cb16-6"><a href="#cb16-6"></a><span class="dv">9</span> <span class="dv">3</span> <span class="dv">2</span> <span class="dv">6</span> <span class="dv">5</span> <span class="dv">1</span> <span class="dv">4</span> <span class="dv">8</span> <span class="dv">7</span></span>
<span id="cb16-7"><a href="#cb16-7"></a><span class="dv">5</span> <span class="dv">6</span> <span class="dv">8</span> <span class="dv">2</span> <span class="dv">4</span> <span class="dv">7</span> <span class="dv">3</span> <span class="dv">9</span> <span class="dv">1</span></span>
<span id="cb16-8"><a href="#cb16-8"></a><span class="dv">7</span> <span class="dv">4</span> <span class="dv">1</span> <span class="dv">3</span> <span class="dv">9</span> <span class="dv">8</span> <span class="dv">6</span> <span class="dv">2</span> <span class="dv">5</span></span>
<span id="cb16-9"><a href="#cb16-9"></a><span class="dv">3</span> <span class="dv">1</span> <span class="dv">9</span> <span class="dv">4</span> <span class="dv">7</span> <span class="dv">5</span> <span class="dv">2</span> <span class="dv">6</span> <span class="dv">8</span></span>
<span id="cb16-10"><a href="#cb16-10"></a><span class="dv">8</span> <span class="dv">5</span> <span class="dv">6</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">9</span> <span class="dv">7</span> <span class="dv">4</span> <span class="dv">3</span></span>
<span id="cb16-11"><a href="#cb16-11"></a><span class="dv">2</span> <span class="dv">7</span> <span class="dv">4</span> <span class="dv">8</span> <span class="dv">3</span> <span class="dv">6</span> <span class="dv">1</span> <span class="dv">5</span> <span class="dv">9</span></span>
<span id="cb16-12"><a href="#cb16-12"></a><span class="op">*</span><span class="dt">Main</span><span class="op">&gt;</span> <span class="fu">putStr</span> <span class="op">$</span> showGrid <span class="op">$</span> Data.List.transpose grid</span>
<span id="cb16-13"><a href="#cb16-13"></a><span class="dv">6</span> <span class="dv">4</span> <span class="dv">1</span> <span class="dv">9</span> <span class="dv">5</span> <span class="dv">7</span> <span class="dv">3</span> <span class="dv">8</span> <span class="dv">2</span></span>
<span id="cb16-14"><a href="#cb16-14"></a><span class="dv">9</span> <span class="dv">8</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">6</span> <span class="dv">4</span> <span class="dv">1</span> <span class="dv">5</span> <span class="dv">7</span></span>
<span id="cb16-15"><a href="#cb16-15"></a><span class="dv">3</span> <span class="dv">7</span> <span class="dv">5</span> <span class="dv">2</span> <span class="dv">8</span> <span class="dv">1</span> <span class="dv">9</span> <span class="dv">6</span> <span class="dv">4</span></span>
<span id="cb16-16"><a href="#cb16-16"></a><span class="dv">7</span> <span class="dv">5</span> <span class="dv">9</span> <span class="dv">6</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">1</span> <span class="dv">8</span></span>
<span id="cb16-17"><a href="#cb16-17"></a><span class="dv">8</span> <span class="dv">1</span> <span class="dv">6</span> <span class="dv">5</span> <span class="dv">4</span> <span class="dv">9</span> <span class="dv">7</span> <span class="dv">2</span> <span class="dv">3</span></span>
<span id="cb16-18"><a href="#cb16-18"></a><span class="dv">4</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">1</span> <span class="dv">7</span> <span class="dv">8</span> <span class="dv">5</span> <span class="dv">9</span> <span class="dv">6</span></span>
<span id="cb16-19"><a href="#cb16-19"></a><span class="dv">5</span> <span class="dv">9</span> <span class="dv">8</span> <span class="dv">4</span> <span class="dv">3</span> <span class="dv">6</span> <span class="dv">2</span> <span class="dv">7</span> <span class="dv">1</span></span>
<span id="cb16-20"><a href="#cb16-20"></a><span class="dv">1</span> <span class="dv">3</span> <span class="dv">7</span> <span class="dv">8</span> <span class="dv">9</span> <span class="dv">2</span> <span class="dv">6</span> <span class="dv">4</span> <span class="dv">5</span></span>
<span id="cb16-21"><a href="#cb16-21"></a><span class="dv">2</span> <span class="dv">6</span> <span class="dv">4</span> <span class="dv">7</span> <span class="dv">1</span> <span class="dv">5</span> <span class="dv">8</span> <span class="dv">3</span> <span class="dv">9</span></span></code></pre></div>


<p>Pruning columns is easy now:</p>


<div class="sourceCode" id="cb17"><pre class="sourceCode small haskell overflow"><code class="sourceCode haskell"><span id="cb17-1"><a href="#cb17-1"></a><span class="op">*</span><span class="dt">Main</span><span class="op">&gt;</span> <span class="dt">Just</span> grid <span class="ot">=</span> readGrid <span class="st">&quot;6......1.4.........2...........5.4.7..8...3....1.9....3..4..2...5.1........8.6...&quot;</span></span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="op">*</span><span class="dt">Main</span><span class="op">&gt;</span> <span class="dt">Just</span> grid' <span class="ot">=</span> <span class="fu">fmap</span> Data.List.transpose <span class="op">.</span> <span class="fu">traverse</span> pruneCells <span class="op">.</span> Data.List.transpose <span class="op">$</span> grid</span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="op">*</span><span class="dt">Main</span><span class="op">&gt;</span> <span class="fu">putStr</span> <span class="op">$</span> showGridWithPossibilities grid'</span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="dv">6</span>           [<span class="dv">1</span> <span class="dv">34</span> <span class="dv">6789</span>] [ <span class="dv">234567</span> <span class="dv">9</span>] [ <span class="dv">23</span> <span class="dv">567</span> <span class="dv">9</span>] [<span class="dv">1234</span> <span class="dv">678</span> ] [<span class="dv">12345</span> <span class="dv">789</span>] [<span class="dv">1</span>   <span class="dv">56789</span>] <span class="dv">1</span>           [<span class="dv">123456</span> <span class="dv">89</span>]</span>
<span id="cb17-5"><a href="#cb17-5"></a><span class="dv">4</span>           [<span class="dv">1</span> <span class="dv">34</span> <span class="dv">6789</span>] [ <span class="dv">234567</span> <span class="dv">9</span>] [ <span class="dv">23</span> <span class="dv">567</span> <span class="dv">9</span>] [<span class="dv">1234</span> <span class="dv">678</span> ] [<span class="dv">12345</span> <span class="dv">789</span>] [<span class="dv">1</span>   <span class="dv">56789</span>] [ <span class="dv">23456789</span>] [<span class="dv">123456</span> <span class="dv">89</span>]</span>
<span id="cb17-6"><a href="#cb17-6"></a>[<span class="dv">12</span>  <span class="dv">5</span> <span class="dv">789</span>] <span class="dv">2</span>           [ <span class="dv">234567</span> <span class="dv">9</span>] [ <span class="dv">23</span> <span class="dv">567</span> <span class="dv">9</span>] [<span class="dv">1234</span> <span class="dv">678</span> ] [<span class="dv">12345</span> <span class="dv">789</span>] [<span class="dv">1</span>   <span class="dv">56789</span>] [ <span class="dv">23456789</span>] [<span class="dv">123456</span> <span class="dv">89</span>]</span>
<span id="cb17-7"><a href="#cb17-7"></a>[<span class="dv">12</span>  <span class="dv">5</span> <span class="dv">789</span>] [<span class="dv">1</span> <span class="dv">34</span> <span class="dv">6789</span>] [ <span class="dv">234567</span> <span class="dv">9</span>] [ <span class="dv">23</span> <span class="dv">567</span> <span class="dv">9</span>] <span class="dv">5</span>           [<span class="dv">12345</span> <span class="dv">789</span>] <span class="dv">4</span>           [ <span class="dv">23456789</span>] <span class="dv">7</span></span>
<span id="cb17-8"><a href="#cb17-8"></a>[<span class="dv">12</span>  <span class="dv">5</span> <span class="dv">789</span>] [<span class="dv">1</span> <span class="dv">34</span> <span class="dv">6789</span>] <span class="dv">8</span>           [ <span class="dv">23</span> <span class="dv">567</span> <span class="dv">9</span>] [<span class="dv">1234</span> <span class="dv">678</span> ] [<span class="dv">12345</span> <span class="dv">789</span>] <span class="dv">3</span>           [ <span class="dv">23456789</span>] [<span class="dv">123456</span> <span class="dv">89</span>]</span>
<span id="cb17-9"><a href="#cb17-9"></a>[<span class="dv">12</span>  <span class="dv">5</span> <span class="dv">789</span>] [<span class="dv">1</span> <span class="dv">34</span> <span class="dv">6789</span>] <span class="dv">1</span>           [ <span class="dv">23</span> <span class="dv">567</span> <span class="dv">9</span>] <span class="dv">9</span>           [<span class="dv">12345</span> <span class="dv">789</span>] [<span class="dv">1</span>   <span class="dv">56789</span>] [ <span class="dv">23456789</span>] [<span class="dv">123456</span> <span class="dv">89</span>]</span>
<span id="cb17-10"><a href="#cb17-10"></a><span class="dv">3</span>           [<span class="dv">1</span> <span class="dv">34</span> <span class="dv">6789</span>] [ <span class="dv">234567</span> <span class="dv">9</span>] <span class="dv">4</span>           [<span class="dv">1234</span> <span class="dv">678</span> ] [<span class="dv">12345</span> <span class="dv">789</span>] <span class="dv">2</span>           [ <span class="dv">23456789</span>] [<span class="dv">123456</span> <span class="dv">89</span>]</span>
<span id="cb17-11"><a href="#cb17-11"></a>[<span class="dv">12</span>  <span class="dv">5</span> <span class="dv">789</span>] <span class="dv">5</span>           [ <span class="dv">234567</span> <span class="dv">9</span>] <span class="dv">1</span>           [<span class="dv">1234</span> <span class="dv">678</span> ] [<span class="dv">12345</span> <span class="dv">789</span>] [<span class="dv">1</span>   <span class="dv">56789</span>] [ <span class="dv">23456789</span>] [<span class="dv">123456</span> <span class="dv">89</span>]</span>
<span id="cb17-12"><a href="#cb17-12"></a>[<span class="dv">12</span>  <span class="dv">5</span> <span class="dv">789</span>] [<span class="dv">1</span> <span class="dv">34</span> <span class="dv">6789</span>] [ <span class="dv">234567</span> <span class="dv">9</span>] <span class="dv">8</span>           [<span class="dv">1234</span> <span class="dv">678</span> ] <span class="dv">6</span>           [<span class="dv">1</span>   <span class="dv">56789</span>] [ <span class="dv">23456789</span>] [<span class="dv">123456</span> <span class="dv">89</span>]</span></code></pre></div>


<p>First, we <code>transpose</code> the grid to convert the columns into rows. Then, we prune the rows by <code>traverse</code>-ing <code>pruneCells</code> over them. And finally, we turn the rows back into columns by <code>transpose</code>-ing the grid back again. The last <code>transpose</code> needs to be <a href="https://hackage.haskell.org/package/base-4.11.1.0/docs/Prelude.html#v:fmap" target="_blank" rel="noopener"><code>fmap</code></a>-ped because <code>traverse pruneCells</code> returns a <code>Maybe</code>.</p>


<p>Pruning sub-grids is a bit trickier. Following the same idea as pruning columns, we need two functions to transform the sub-grids into rows and back. Let’s write the first one:</p>


<div class="sourceCode" id="cb18"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb18-1"><a href="#cb18-1"></a><span class="ot">subGridsToRows ::</span> <span class="dt">Grid</span> <span class="ot">-&gt;</span> <span class="dt">Grid</span></span>
<span id="cb18-2"><a href="#cb18-2"></a>subGridsToRows <span class="ot">=</span></span>
<span id="cb18-3"><a href="#cb18-3"></a>  <span class="fu">concatMap</span> (\rows <span class="ot">-&gt;</span> <span class="kw">let</span> [r1, r2, r3] <span class="ot">=</span> <span class="fu">map</span> (Data.List.Split.chunksOf <span class="dv">3</span>) rows</span>
<span id="cb18-4"><a href="#cb18-4"></a>                      <span class="kw">in</span> <span class="fu">zipWith3</span> (\a b c <span class="ot">-&gt;</span> a <span class="op">++</span> b <span class="op">++</span> c) r1 r2 r3)</span>
<span id="cb18-5"><a href="#cb18-5"></a>  <span class="op">.</span> Data.List.Split.chunksOf <span class="dv">3</span></span></code></pre></div>


<p>And try it out:</p>


<div class="sourceCode" id="cb19"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb19-1"><a href="#cb19-1"></a><span class="op">*</span><span class="dt">Main</span><span class="op">&gt;</span> <span class="dt">Just</span> grid <span class="ot">=</span> readGrid <span class="st">&quot;693784512487512936125963874932651487568247391741398625319475268856129743274836159&quot;</span></span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="op">*</span><span class="dt">Main</span><span class="op">&gt;</span> <span class="fu">putStr</span> <span class="op">$</span> showGrid grid</span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="dv">6</span> <span class="dv">9</span> <span class="dv">3</span> <span class="dv">7</span> <span class="dv">8</span> <span class="dv">4</span> <span class="dv">5</span> <span class="dv">1</span> <span class="dv">2</span></span>
<span id="cb19-4"><a href="#cb19-4"></a><span class="dv">4</span> <span class="dv">8</span> <span class="dv">7</span> <span class="dv">5</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">9</span> <span class="dv">3</span> <span class="dv">6</span></span>
<span id="cb19-5"><a href="#cb19-5"></a><span class="dv">1</span> <span class="dv">2</span> <span class="dv">5</span> <span class="dv">9</span> <span class="dv">6</span> <span class="dv">3</span> <span class="dv">8</span> <span class="dv">7</span> <span class="dv">4</span></span>
<span id="cb19-6"><a href="#cb19-6"></a><span class="dv">9</span> <span class="dv">3</span> <span class="dv">2</span> <span class="dv">6</span> <span class="dv">5</span> <span class="dv">1</span> <span class="dv">4</span> <span class="dv">8</span> <span class="dv">7</span></span>
<span id="cb19-7"><a href="#cb19-7"></a><span class="dv">5</span> <span class="dv">6</span> <span class="dv">8</span> <span class="dv">2</span> <span class="dv">4</span> <span class="dv">7</span> <span class="dv">3</span> <span class="dv">9</span> <span class="dv">1</span></span>
<span id="cb19-8"><a href="#cb19-8"></a><span class="dv">7</span> <span class="dv">4</span> <span class="dv">1</span> <span class="dv">3</span> <span class="dv">9</span> <span class="dv">8</span> <span class="dv">6</span> <span class="dv">2</span> <span class="dv">5</span></span>
<span id="cb19-9"><a href="#cb19-9"></a><span class="dv">3</span> <span class="dv">1</span> <span class="dv">9</span> <span class="dv">4</span> <span class="dv">7</span> <span class="dv">5</span> <span class="dv">2</span> <span class="dv">6</span> <span class="dv">8</span></span>
<span id="cb19-10"><a href="#cb19-10"></a><span class="dv">8</span> <span class="dv">5</span> <span class="dv">6</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">9</span> <span class="dv">7</span> <span class="dv">4</span> <span class="dv">3</span></span>
<span id="cb19-11"><a href="#cb19-11"></a><span class="dv">2</span> <span class="dv">7</span> <span class="dv">4</span> <span class="dv">8</span> <span class="dv">3</span> <span class="dv">6</span> <span class="dv">1</span> <span class="dv">5</span> <span class="dv">9</span></span>
<span id="cb19-12"><a href="#cb19-12"></a><span class="op">*</span><span class="dt">Main</span><span class="op">&gt;</span> <span class="fu">putStr</span> <span class="op">$</span> showGrid <span class="op">$</span> subGridsToRows grid</span>
<span id="cb19-13"><a href="#cb19-13"></a><span class="dv">6</span> <span class="dv">9</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">8</span> <span class="dv">7</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">5</span></span>
<span id="cb19-14"><a href="#cb19-14"></a><span class="dv">7</span> <span class="dv">8</span> <span class="dv">4</span> <span class="dv">5</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">9</span> <span class="dv">6</span> <span class="dv">3</span></span>
<span id="cb19-15"><a href="#cb19-15"></a><span class="dv">5</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">9</span> <span class="dv">3</span> <span class="dv">6</span> <span class="dv">8</span> <span class="dv">7</span> <span class="dv">4</span></span>
<span id="cb19-16"><a href="#cb19-16"></a><span class="dv">9</span> <span class="dv">3</span> <span class="dv">2</span> <span class="dv">5</span> <span class="dv">6</span> <span class="dv">8</span> <span class="dv">7</span> <span class="dv">4</span> <span class="dv">1</span></span>
<span id="cb19-17"><a href="#cb19-17"></a><span class="dv">6</span> <span class="dv">5</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">4</span> <span class="dv">7</span> <span class="dv">3</span> <span class="dv">9</span> <span class="dv">8</span></span>
<span id="cb19-18"><a href="#cb19-18"></a><span class="dv">4</span> <span class="dv">8</span> <span class="dv">7</span> <span class="dv">3</span> <span class="dv">9</span> <span class="dv">1</span> <span class="dv">6</span> <span class="dv">2</span> <span class="dv">5</span></span>
<span id="cb19-19"><a href="#cb19-19"></a><span class="dv">3</span> <span class="dv">1</span> <span class="dv">9</span> <span class="dv">8</span> <span class="dv">5</span> <span class="dv">6</span> <span class="dv">2</span> <span class="dv">7</span> <span class="dv">4</span></span>
<span id="cb19-20"><a href="#cb19-20"></a><span class="dv">4</span> <span class="dv">7</span> <span class="dv">5</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">9</span> <span class="dv">8</span> <span class="dv">3</span> <span class="dv">6</span></span>
<span id="cb19-21"><a href="#cb19-21"></a><span class="dv">2</span> <span class="dv">6</span> <span class="dv">8</span> <span class="dv">7</span> <span class="dv">4</span> <span class="dv">3</span> <span class="dv">1</span> <span class="dv">5</span> <span class="dv">9</span></span></code></pre></div>


<p>You can go over the code and the output and make yourself sure that it works. Also, it turns out that we don’t need to write the back-transform function. <code>subGridsToRows</code> is its own back-transform:</p>


<div class="sourceCode" id="cb20"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb20-1"><a href="#cb20-1"></a><span class="op">*</span><span class="dt">Main</span><span class="op">&gt;</span> <span class="fu">putStr</span> <span class="op">$</span> showGrid grid</span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="dv">6</span> <span class="dv">9</span> <span class="dv">3</span> <span class="dv">7</span> <span class="dv">8</span> <span class="dv">4</span> <span class="dv">5</span> <span class="dv">1</span> <span class="dv">2</span></span>
<span id="cb20-3"><a href="#cb20-3"></a><span class="dv">4</span> <span class="dv">8</span> <span class="dv">7</span> <span class="dv">5</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">9</span> <span class="dv">3</span> <span class="dv">6</span></span>
<span id="cb20-4"><a href="#cb20-4"></a><span class="dv">1</span> <span class="dv">2</span> <span class="dv">5</span> <span class="dv">9</span> <span class="dv">6</span> <span class="dv">3</span> <span class="dv">8</span> <span class="dv">7</span> <span class="dv">4</span></span>
<span id="cb20-5"><a href="#cb20-5"></a><span class="dv">9</span> <span class="dv">3</span> <span class="dv">2</span> <span class="dv">6</span> <span class="dv">5</span> <span class="dv">1</span> <span class="dv">4</span> <span class="dv">8</span> <span class="dv">7</span></span>
<span id="cb20-6"><a href="#cb20-6"></a><span class="dv">5</span> <span class="dv">6</span> <span class="dv">8</span> <span class="dv">2</span> <span class="dv">4</span> <span class="dv">7</span> <span class="dv">3</span> <span class="dv">9</span> <span class="dv">1</span></span>
<span id="cb20-7"><a href="#cb20-7"></a><span class="dv">7</span> <span class="dv">4</span> <span class="dv">1</span> <span class="dv">3</span> <span class="dv">9</span> <span class="dv">8</span> <span class="dv">6</span> <span class="dv">2</span> <span class="dv">5</span></span>
<span id="cb20-8"><a href="#cb20-8"></a><span class="dv">3</span> <span class="dv">1</span> <span class="dv">9</span> <span class="dv">4</span> <span class="dv">7</span> <span class="dv">5</span> <span class="dv">2</span> <span class="dv">6</span> <span class="dv">8</span></span>
<span id="cb20-9"><a href="#cb20-9"></a><span class="dv">8</span> <span class="dv">5</span> <span class="dv">6</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">9</span> <span class="dv">7</span> <span class="dv">4</span> <span class="dv">3</span></span>
<span id="cb20-10"><a href="#cb20-10"></a><span class="dv">2</span> <span class="dv">7</span> <span class="dv">4</span> <span class="dv">8</span> <span class="dv">3</span> <span class="dv">6</span> <span class="dv">1</span> <span class="dv">5</span> <span class="dv">9</span></span>
<span id="cb20-11"><a href="#cb20-11"></a><span class="op">*</span><span class="dt">Main</span><span class="op">&gt;</span> <span class="fu">putStr</span> <span class="op">$</span> showGrid <span class="op">$</span> subGridsToRows <span class="op">$</span> subGridsToRows <span class="op">$</span> grid</span>
<span id="cb20-12"><a href="#cb20-12"></a><span class="dv">6</span> <span class="dv">9</span> <span class="dv">3</span> <span class="dv">7</span> <span class="dv">8</span> <span class="dv">4</span> <span class="dv">5</span> <span class="dv">1</span> <span class="dv">2</span></span>
<span id="cb20-13"><a href="#cb20-13"></a><span class="dv">4</span> <span class="dv">8</span> <span class="dv">7</span> <span class="dv">5</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">9</span> <span class="dv">3</span> <span class="dv">6</span></span>
<span id="cb20-14"><a href="#cb20-14"></a><span class="dv">1</span> <span class="dv">2</span> <span class="dv">5</span> <span class="dv">9</span> <span class="dv">6</span> <span class="dv">3</span> <span class="dv">8</span> <span class="dv">7</span> <span class="dv">4</span></span>
<span id="cb20-15"><a href="#cb20-15"></a><span class="dv">9</span> <span class="dv">3</span> <span class="dv">2</span> <span class="dv">6</span> <span class="dv">5</span> <span class="dv">1</span> <span class="dv">4</span> <span class="dv">8</span> <span class="dv">7</span></span>
<span id="cb20-16"><a href="#cb20-16"></a><span class="dv">5</span> <span class="dv">6</span> <span class="dv">8</span> <span class="dv">2</span> <span class="dv">4</span> <span class="dv">7</span> <span class="dv">3</span> <span class="dv">9</span> <span class="dv">1</span></span>
<span id="cb20-17"><a href="#cb20-17"></a><span class="dv">7</span> <span class="dv">4</span> <span class="dv">1</span> <span class="dv">3</span> <span class="dv">9</span> <span class="dv">8</span> <span class="dv">6</span> <span class="dv">2</span> <span class="dv">5</span></span>
<span id="cb20-18"><a href="#cb20-18"></a><span class="dv">3</span> <span class="dv">1</span> <span class="dv">9</span> <span class="dv">4</span> <span class="dv">7</span> <span class="dv">5</span> <span class="dv">2</span> <span class="dv">6</span> <span class="dv">8</span></span>
<span id="cb20-19"><a href="#cb20-19"></a><span class="dv">8</span> <span class="dv">5</span> <span class="dv">6</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">9</span> <span class="dv">7</span> <span class="dv">4</span> <span class="dv">3</span></span>
<span id="cb20-20"><a href="#cb20-20"></a><span class="dv">2</span> <span class="dv">7</span> <span class="dv">4</span> <span class="dv">8</span> <span class="dv">3</span> <span class="dv">6</span> <span class="dv">1</span> <span class="dv">5</span> <span class="dv">9</span></span></code></pre></div>


<p>Nice! Now writing the sub-grid pruning function is easy:</p>


<div class="sourceCode" id="cb21"><pre class="sourceCode small haskell overflow"><code class="sourceCode haskell"><span id="cb21-1"><a href="#cb21-1"></a><span class="op">*</span><span class="dt">Main</span><span class="op">&gt;</span> <span class="dt">Just</span> grid <span class="ot">=</span> readGrid <span class="st">&quot;6......1.4.........2...........5.4.7..8...3....1.9....3..4..2...5.1........8.6...&quot;</span></span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="op">*</span><span class="dt">Main</span><span class="op">&gt;</span> <span class="dt">Just</span> grid' <span class="ot">=</span> <span class="fu">fmap</span> subGridsToRows <span class="op">.</span> <span class="fu">traverse</span> pruneCells <span class="op">.</span> subGridsToRows <span class="op">$</span> grid</span>
<span id="cb21-3"><a href="#cb21-3"></a><span class="op">*</span><span class="dt">Main</span><span class="op">&gt;</span> <span class="fu">putStr</span> <span class="op">$</span> showGridWithPossibilities grid'</span>
<span id="cb21-4"><a href="#cb21-4"></a><span class="dv">6</span>           [<span class="dv">1</span> <span class="dv">3</span> <span class="dv">5</span> <span class="dv">789</span>] [<span class="dv">1</span> <span class="dv">3</span> <span class="dv">5</span> <span class="dv">789</span>] [<span class="dv">123456789</span>] [<span class="dv">123456789</span>] [<span class="dv">123456789</span>] [ <span class="dv">23456789</span>] <span class="dv">1</span>           [ <span class="dv">23456789</span>]</span>
<span id="cb21-5"><a href="#cb21-5"></a><span class="dv">4</span>           [<span class="dv">1</span> <span class="dv">3</span> <span class="dv">5</span> <span class="dv">789</span>] [<span class="dv">1</span> <span class="dv">3</span> <span class="dv">5</span> <span class="dv">789</span>] [<span class="dv">123456789</span>] [<span class="dv">123456789</span>] [<span class="dv">123456789</span>] [ <span class="dv">23456789</span>] [ <span class="dv">23456789</span>] [ <span class="dv">23456789</span>]</span>
<span id="cb21-6"><a href="#cb21-6"></a>[<span class="dv">1</span> <span class="dv">3</span> <span class="dv">5</span> <span class="dv">789</span>] <span class="dv">2</span>           [<span class="dv">1</span> <span class="dv">3</span> <span class="dv">5</span> <span class="dv">789</span>] [<span class="dv">123456789</span>] [<span class="dv">123456789</span>] [<span class="dv">123456789</span>] [ <span class="dv">23456789</span>] [ <span class="dv">23456789</span>] [ <span class="dv">23456789</span>]</span>
<span id="cb21-7"><a href="#cb21-7"></a>[ <span class="dv">234567</span> <span class="dv">9</span>] [ <span class="dv">234567</span> <span class="dv">9</span>] [ <span class="dv">234567</span> <span class="dv">9</span>] [<span class="dv">1234</span> <span class="dv">678</span> ] <span class="dv">5</span>           [<span class="dv">1234</span> <span class="dv">678</span> ] <span class="dv">4</span>           [<span class="dv">12</span>  <span class="dv">56</span> <span class="dv">89</span>] <span class="dv">7</span></span>
<span id="cb21-8"><a href="#cb21-8"></a>[ <span class="dv">234567</span> <span class="dv">9</span>] [ <span class="dv">234567</span> <span class="dv">9</span>] <span class="dv">8</span>           [<span class="dv">1234</span> <span class="dv">678</span> ] [<span class="dv">1234</span> <span class="dv">678</span> ] [<span class="dv">1234</span> <span class="dv">678</span> ] <span class="dv">3</span>           [<span class="dv">12</span>  <span class="dv">56</span> <span class="dv">89</span>] [<span class="dv">12</span>  <span class="dv">56</span> <span class="dv">89</span>]</span>
<span id="cb21-9"><a href="#cb21-9"></a>[ <span class="dv">234567</span> <span class="dv">9</span>] [ <span class="dv">234567</span> <span class="dv">9</span>] <span class="dv">1</span>           [<span class="dv">1234</span> <span class="dv">678</span> ] <span class="dv">9</span>           [<span class="dv">1234</span> <span class="dv">678</span> ] [<span class="dv">12</span>  <span class="dv">56</span> <span class="dv">89</span>] [<span class="dv">12</span>  <span class="dv">56</span> <span class="dv">89</span>] [<span class="dv">12</span>  <span class="dv">56</span> <span class="dv">89</span>]</span>
<span id="cb21-10"><a href="#cb21-10"></a><span class="dv">3</span>           [<span class="dv">12</span> <span class="dv">4</span> <span class="dv">6789</span>] [<span class="dv">12</span> <span class="dv">4</span> <span class="dv">6789</span>] <span class="dv">4</span>           [ <span class="dv">23</span> <span class="dv">5</span> <span class="dv">7</span> <span class="dv">9</span>] [ <span class="dv">23</span> <span class="dv">5</span> <span class="dv">7</span> <span class="dv">9</span>] <span class="dv">2</span>           [<span class="dv">1</span> <span class="dv">3456789</span>] [<span class="dv">1</span> <span class="dv">3456789</span>]</span>
<span id="cb21-11"><a href="#cb21-11"></a>[<span class="dv">12</span> <span class="dv">4</span> <span class="dv">6789</span>] <span class="dv">5</span>           [<span class="dv">12</span> <span class="dv">4</span> <span class="dv">6789</span>] <span class="dv">1</span>           [ <span class="dv">23</span> <span class="dv">5</span> <span class="dv">7</span> <span class="dv">9</span>] [ <span class="dv">23</span> <span class="dv">5</span> <span class="dv">7</span> <span class="dv">9</span>] [<span class="dv">1</span> <span class="dv">3456789</span>] [<span class="dv">1</span> <span class="dv">3456789</span>] [<span class="dv">1</span> <span class="dv">3456789</span>]</span>
<span id="cb21-12"><a href="#cb21-12"></a>[<span class="dv">12</span> <span class="dv">4</span> <span class="dv">6789</span>] [<span class="dv">12</span> <span class="dv">4</span> <span class="dv">6789</span>] [<span class="dv">12</span> <span class="dv">4</span> <span class="dv">6789</span>] <span class="dv">8</span>           [ <span class="dv">23</span> <span class="dv">5</span> <span class="dv">7</span> <span class="dv">9</span>] <span class="dv">6</span>           [<span class="dv">1</span> <span class="dv">3456789</span>] [<span class="dv">1</span> <span class="dv">3456789</span>] [<span class="dv">1</span> <span class="dv">3456789</span>]</span></code></pre></div>


<p>It works well. Now we can string together these three steps to prune the entire grid. We also have to make sure that result of pruning each step is fed into the next step. This is so that the fixed cells created into one step cause more pruning in the further steps. We use monadic bind (<a href="https://hackage.haskell.org/package/base-4.10.1.0/docs/Control-Monad.html#v:-62--62--61-" target="_blank" rel="noopener"><code>&gt;&gt;=</code></a>) for that. Here’s the final code:</p>


<div class="sourceCode" id="cb22"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb22-1"><a href="#cb22-1"></a><span class="ot">pruneGrid' ::</span> <span class="dt">Grid</span> <span class="ot">-&gt;</span> <span class="dt">Maybe</span> <span class="dt">Grid</span></span>
<span id="cb22-2"><a href="#cb22-2"></a>pruneGrid' grid <span class="ot">=</span></span>
<span id="cb22-3"><a href="#cb22-3"></a>  <span class="fu">traverse</span> pruneCells grid</span>
<span id="cb22-4"><a href="#cb22-4"></a>  <span class="op">&gt;&gt;=</span> <span class="fu">fmap</span> Data.List.transpose <span class="op">.</span> <span class="fu">traverse</span> pruneCells <span class="op">.</span> Data.List.transpose</span>
<span id="cb22-5"><a href="#cb22-5"></a>  <span class="op">&gt;&gt;=</span> <span class="fu">fmap</span> subGridsToRows <span class="op">.</span> <span class="fu">traverse</span> pruneCells <span class="op">.</span> subGridsToRows</span></code></pre></div>


<p>And the test:</p>


<div class="sourceCode" id="cb23"><pre class="sourceCode small haskell overflow"><code class="sourceCode haskell"><span id="cb23-1"><a href="#cb23-1"></a><span class="op">*</span><span class="dt">Main</span><span class="op">&gt;</span> <span class="dt">Just</span> grid <span class="ot">=</span> readGrid <span class="st">&quot;6......1.4.........2...........5.4.7..8...3....1.9....3..4..2...5.1........8.6...&quot;</span></span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="op">*</span><span class="dt">Main</span><span class="op">&gt;</span> <span class="dt">Just</span> grid' <span class="ot">=</span> pruneGrid' grid</span>
<span id="cb23-3"><a href="#cb23-3"></a><span class="op">*</span><span class="dt">Main</span><span class="op">&gt;</span> <span class="fu">putStr</span> <span class="op">$</span> showGridWithPossibilities grid'</span>
<span id="cb23-4"><a href="#cb23-4"></a><span class="dv">6</span>           [  <span class="dv">3</span>   <span class="dv">789</span>] [  <span class="dv">3</span> <span class="dv">5</span> <span class="dv">7</span> <span class="dv">9</span>] [ <span class="dv">23</span> <span class="dv">5</span> <span class="dv">7</span> <span class="dv">9</span>] [ <span class="dv">234</span>  <span class="dv">78</span> ] [ <span class="dv">2345</span> <span class="dv">789</span>] [    <span class="dv">5</span> <span class="dv">789</span>] <span class="dv">1</span>           [ <span class="dv">2345</span>  <span class="dv">89</span>]</span>
<span id="cb23-5"><a href="#cb23-5"></a><span class="dv">4</span>           [<span class="dv">1</span> <span class="dv">3</span>   <span class="dv">789</span>] [  <span class="dv">3</span> <span class="dv">5</span> <span class="dv">7</span> <span class="dv">9</span>] [ <span class="dv">23</span> <span class="dv">567</span> <span class="dv">9</span>] [<span class="dv">123</span>  <span class="dv">678</span> ] [<span class="dv">123</span> <span class="dv">5</span> <span class="dv">789</span>] [    <span class="dv">56789</span>] [ <span class="dv">23</span> <span class="dv">56789</span>] [ <span class="dv">23</span> <span class="dv">56</span> <span class="dv">89</span>]</span>
<span id="cb23-6"><a href="#cb23-6"></a>[<span class="dv">1</span>   <span class="dv">5</span> <span class="dv">789</span>] <span class="dv">2</span>           [  <span class="dv">3</span> <span class="dv">5</span> <span class="dv">7</span> <span class="dv">9</span>] [  <span class="dv">3</span> <span class="dv">567</span> <span class="dv">9</span>] [<span class="dv">1</span> <span class="dv">34</span> <span class="dv">678</span> ] [<span class="dv">1</span> <span class="dv">345</span> <span class="dv">789</span>] [    <span class="dv">56789</span>] [  <span class="dv">3456789</span>] [  <span class="dv">3456</span> <span class="dv">89</span>]</span>
<span id="cb23-7"><a href="#cb23-7"></a>[ <span class="dv">2</span>      <span class="dv">9</span>] [  <span class="dv">3</span>  <span class="dv">6</span>  <span class="dv">9</span>] [ <span class="dv">23</span>  <span class="dv">6</span>  <span class="dv">9</span>] [ <span class="dv">23</span>  <span class="dv">6</span>   ] <span class="dv">5</span>           [<span class="dv">123</span>    <span class="dv">8</span> ] <span class="dv">4</span>           [ <span class="dv">2</span>   <span class="dv">6</span> <span class="dv">89</span>] <span class="dv">7</span></span>
<span id="cb23-8"><a href="#cb23-8"></a>[ <span class="dv">2</span>  <span class="dv">5</span> <span class="dv">7</span> <span class="dv">9</span>] [   <span class="dv">4</span> <span class="dv">67</span> <span class="dv">9</span>] <span class="dv">8</span>           [ <span class="dv">2</span>   <span class="dv">67</span>  ] [<span class="dv">12</span> <span class="dv">4</span> <span class="dv">67</span>  ] [<span class="dv">12</span> <span class="dv">4</span>  <span class="dv">7</span>  ] <span class="dv">3</span>           [ <span class="dv">2</span>  <span class="dv">56</span>  <span class="dv">9</span>] [<span class="dv">12</span>  <span class="dv">56</span>  <span class="dv">9</span>]</span>
<span id="cb23-9"><a href="#cb23-9"></a>[ <span class="dv">2</span>  <span class="dv">5</span> <span class="dv">7</span>  ] [  <span class="dv">34</span> <span class="dv">67</span>  ] <span class="dv">1</span>           [ <span class="dv">23</span>  <span class="dv">67</span>  ] <span class="dv">9</span>           [ <span class="dv">234</span>  <span class="dv">78</span> ] [    <span class="dv">56</span> <span class="dv">8</span> ] [ <span class="dv">2</span>  <span class="dv">56</span> <span class="dv">8</span> ] [ <span class="dv">2</span>  <span class="dv">56</span> <span class="dv">8</span> ]</span>
<span id="cb23-10"><a href="#cb23-10"></a><span class="dv">3</span>           [<span class="dv">1</span>    <span class="dv">6789</span>] [     <span class="dv">67</span> <span class="dv">9</span>] <span class="dv">4</span>           <span class="dv">7</span>           [    <span class="dv">5</span> <span class="dv">7</span> <span class="dv">9</span>] <span class="dv">2</span>           [    <span class="dv">56789</span>] [<span class="dv">1</span>   <span class="dv">56</span> <span class="dv">89</span>]</span>
<span id="cb23-11"><a href="#cb23-11"></a>[ <span class="dv">2</span>    <span class="dv">789</span>] <span class="dv">5</span>           [ <span class="dv">2</span> <span class="dv">4</span> <span class="dv">67</span> <span class="dv">9</span>] <span class="dv">1</span>           [ <span class="dv">23</span>   <span class="dv">7</span>  ] [ <span class="dv">23</span>   <span class="dv">7</span> <span class="dv">9</span>] [     <span class="dv">6789</span>] [  <span class="dv">34</span> <span class="dv">6789</span>] [  <span class="dv">34</span> <span class="dv">6</span> <span class="dv">89</span>]</span>
<span id="cb23-12"><a href="#cb23-12"></a>[<span class="dv">12</span>    <span class="dv">7</span> <span class="dv">9</span>] [<span class="dv">1</span>  <span class="dv">4</span>  <span class="dv">7</span> <span class="dv">9</span>] [ <span class="dv">2</span> <span class="dv">4</span>  <span class="dv">7</span> <span class="dv">9</span>] <span class="dv">8</span>           [ <span class="dv">23</span>   <span class="dv">7</span>  ] <span class="dv">6</span>           [<span class="dv">1</span>   <span class="dv">5</span> <span class="dv">7</span> <span class="dv">9</span>] [  <span class="dv">345</span> <span class="dv">7</span> <span class="dv">9</span>] [<span class="dv">1</span> <span class="dv">345</span>   <span class="dv">9</span>]</span>
<span id="cb23-13"><a href="#cb23-13"></a><span class="op">*</span><span class="dt">Main</span><span class="op">&gt;</span> <span class="fu">putStr</span> <span class="op">$</span> showGrid grid</span>
<span id="cb23-14"><a href="#cb23-14"></a><span class="dv">6</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="dv">1</span> <span class="op">.</span></span>
<span id="cb23-15"><a href="#cb23-15"></a><span class="dv">4</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span></span>
<span id="cb23-16"><a href="#cb23-16"></a><span class="op">.</span> <span class="dv">2</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span></span>
<span id="cb23-17"><a href="#cb23-17"></a><span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="dv">5</span> <span class="op">.</span> <span class="dv">4</span> <span class="op">.</span> <span class="dv">7</span></span>
<span id="cb23-18"><a href="#cb23-18"></a><span class="op">.</span> <span class="op">.</span> <span class="dv">8</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="dv">3</span> <span class="op">.</span> <span class="op">.</span></span>
<span id="cb23-19"><a href="#cb23-19"></a><span class="op">.</span> <span class="op">.</span> <span class="dv">1</span> <span class="op">.</span> <span class="dv">9</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span></span>
<span id="cb23-20"><a href="#cb23-20"></a><span class="dv">3</span> <span class="op">.</span> <span class="op">.</span> <span class="dv">4</span> <span class="op">.</span> <span class="op">.</span> <span class="dv">2</span> <span class="op">.</span> <span class="op">.</span></span>
<span id="cb23-21"><a href="#cb23-21"></a><span class="op">.</span> <span class="dv">5</span> <span class="op">.</span> <span class="dv">1</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span></span>
<span id="cb23-22"><a href="#cb23-22"></a><span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="dv">8</span> <span class="op">.</span> <span class="dv">6</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span></span>
<span id="cb23-23"><a href="#cb23-23"></a><span class="op">*</span><span class="dt">Main</span><span class="op">&gt;</span> <span class="fu">putStr</span> <span class="op">$</span> showGrid grid'</span>
<span id="cb23-24"><a href="#cb23-24"></a><span class="dv">6</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="dv">1</span> <span class="op">.</span></span>
<span id="cb23-25"><a href="#cb23-25"></a><span class="dv">4</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span></span>
<span id="cb23-26"><a href="#cb23-26"></a><span class="op">.</span> <span class="dv">2</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span></span>
<span id="cb23-27"><a href="#cb23-27"></a><span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="dv">5</span> <span class="op">.</span> <span class="dv">4</span> <span class="op">.</span> <span class="dv">7</span></span>
<span id="cb23-28"><a href="#cb23-28"></a><span class="op">.</span> <span class="op">.</span> <span class="dv">8</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="dv">3</span> <span class="op">.</span> <span class="op">.</span></span>
<span id="cb23-29"><a href="#cb23-29"></a><span class="op">.</span> <span class="op">.</span> <span class="dv">1</span> <span class="op">.</span> <span class="dv">9</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span></span>
<span id="cb23-30"><a href="#cb23-30"></a><span class="dv">3</span> <span class="op">.</span> <span class="op">.</span> <span class="dv">4</span> <span class="dv">7</span> <span class="op">.</span> <span class="dv">2</span> <span class="op">.</span> <span class="op">.</span></span>
<span id="cb23-31"><a href="#cb23-31"></a><span class="op">.</span> <span class="dv">5</span> <span class="op">.</span> <span class="dv">1</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span></span>
<span id="cb23-32"><a href="#cb23-32"></a><span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="dv">8</span> <span class="op">.</span> <span class="dv">6</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span></span></code></pre></div>


<p>We can clearly see the massive pruning of possibilities all around the grid. We also see a <code>7</code> pop up in the row-7-column-5 cell. This means that we can prune the grid further, until it settles. If you are familiar with Haskell, you may recognize this as trying to find a <a href="https://en.wikipedia.org/wiki/Fixed_point_%28mathematics%29" target="_blank" rel="noopener">fixed point</a> for the <code>pruneGrid'</code> function, except in a monadic context. It is simple to implement:</p>


<div class="sourceCode" id="cb24"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb24-1"><a href="#cb24-1"></a><span class="ot">pruneGrid ::</span> <span class="dt">Grid</span> <span class="ot">-&gt;</span> <span class="dt">Maybe</span> <span class="dt">Grid</span></span>
<span id="cb24-2"><a href="#cb24-2"></a>pruneGrid <span class="ot">=</span> fixM pruneGrid'</span>
<span id="cb24-3"><a href="#cb24-3"></a>  <span class="kw">where</span></span>
<span id="cb24-4"><a href="#cb24-4"></a>    fixM f x <span class="ot">=</span> f x <span class="op">&gt;&gt;=</span> \x' <span class="ot">-&gt;</span> <span class="kw">if</span> x' <span class="op">==</span> x <span class="kw">then</span> <span class="fu">return</span> x <span class="kw">else</span> fixM f x'</span></code></pre></div>


<p>The crux of this code is the <code>fixM</code> function. It takes a monadic function <code>f</code> and an initial value, and recursively calls itself till the return value settles. Let’s do another round in the <em>REPL</em>:</p>


<div class="sourceCode" id="cb25"><pre class="sourceCode small haskell overflow"><code class="sourceCode haskell"><span id="cb25-1"><a href="#cb25-1"></a><span class="op">*</span><span class="dt">Main</span><span class="op">&gt;</span> <span class="dt">Just</span> grid <span class="ot">=</span> readGrid <span class="st">&quot;6......1.4.........2...........5.4.7..8...3....1.9....3..4..2...5.1........8.6...&quot;</span></span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="op">*</span><span class="dt">Main</span><span class="op">&gt;</span> <span class="dt">Just</span> grid' <span class="ot">=</span> pruneGrid grid</span>
<span id="cb25-3"><a href="#cb25-3"></a><span class="op">*</span><span class="dt">Main</span><span class="op">&gt;</span> <span class="fu">putStr</span> <span class="op">$</span> showGridWithPossibilities grid'</span>
<span id="cb25-4"><a href="#cb25-4"></a><span class="dv">6</span>           [  <span class="dv">3</span>   <span class="dv">789</span>] [  <span class="dv">3</span> <span class="dv">5</span> <span class="dv">7</span> <span class="dv">9</span>] [ <span class="dv">23</span> <span class="dv">5</span> <span class="dv">7</span> <span class="dv">9</span>] [ <span class="dv">234</span>   <span class="dv">8</span> ] [ <span class="dv">2345</span> <span class="dv">789</span>] [    <span class="dv">5</span> <span class="dv">789</span>] <span class="dv">1</span>           [ <span class="dv">2345</span>  <span class="dv">89</span>]</span>
<span id="cb25-5"><a href="#cb25-5"></a><span class="dv">4</span>           [<span class="dv">1</span> <span class="dv">3</span>   <span class="dv">789</span>] [  <span class="dv">3</span> <span class="dv">5</span> <span class="dv">7</span> <span class="dv">9</span>] [ <span class="dv">23</span> <span class="dv">567</span> <span class="dv">9</span>] [<span class="dv">123</span>  <span class="dv">6</span> <span class="dv">8</span> ] [<span class="dv">123</span> <span class="dv">5</span> <span class="dv">789</span>] [    <span class="dv">56789</span>] [ <span class="dv">23</span> <span class="dv">56789</span>] [ <span class="dv">23</span> <span class="dv">56</span> <span class="dv">89</span>]</span>
<span id="cb25-6"><a href="#cb25-6"></a>[<span class="dv">1</span>   <span class="dv">5</span> <span class="dv">789</span>] <span class="dv">2</span>           [  <span class="dv">3</span> <span class="dv">5</span> <span class="dv">7</span> <span class="dv">9</span>] [  <span class="dv">3</span> <span class="dv">567</span> <span class="dv">9</span>] [<span class="dv">1</span> <span class="dv">34</span> <span class="dv">6</span> <span class="dv">8</span> ] [<span class="dv">1</span> <span class="dv">345</span> <span class="dv">789</span>] [    <span class="dv">56789</span>] [  <span class="dv">3456789</span>] [  <span class="dv">3456</span> <span class="dv">89</span>]</span>
<span id="cb25-7"><a href="#cb25-7"></a>[ <span class="dv">2</span>      <span class="dv">9</span>] [  <span class="dv">3</span>  <span class="dv">6</span>  <span class="dv">9</span>] [ <span class="dv">23</span>  <span class="dv">6</span>  <span class="dv">9</span>] [ <span class="dv">23</span>  <span class="dv">6</span>   ] <span class="dv">5</span>           [<span class="dv">123</span>    <span class="dv">8</span> ] <span class="dv">4</span>           [ <span class="dv">2</span>   <span class="dv">6</span> <span class="dv">89</span>] <span class="dv">7</span></span>
<span id="cb25-8"><a href="#cb25-8"></a>[ <span class="dv">2</span>  <span class="dv">5</span> <span class="dv">7</span> <span class="dv">9</span>] [   <span class="dv">4</span> <span class="dv">67</span> <span class="dv">9</span>] <span class="dv">8</span>           [ <span class="dv">2</span>   <span class="dv">67</span>  ] [<span class="dv">12</span> <span class="dv">4</span> <span class="dv">6</span>   ] [<span class="dv">12</span> <span class="dv">4</span>  <span class="dv">7</span>  ] <span class="dv">3</span>           [ <span class="dv">2</span>  <span class="dv">56</span>  <span class="dv">9</span>] [<span class="dv">12</span>  <span class="dv">56</span>  <span class="dv">9</span>]</span>
<span id="cb25-9"><a href="#cb25-9"></a>[ <span class="dv">2</span>  <span class="dv">5</span> <span class="dv">7</span>  ] [  <span class="dv">34</span> <span class="dv">67</span>  ] <span class="dv">1</span>           [ <span class="dv">23</span>  <span class="dv">67</span>  ] <span class="dv">9</span>           [ <span class="dv">234</span>  <span class="dv">78</span> ] [    <span class="dv">56</span> <span class="dv">8</span> ] [ <span class="dv">2</span>  <span class="dv">56</span> <span class="dv">8</span> ] [ <span class="dv">2</span>  <span class="dv">56</span> <span class="dv">8</span> ]</span>
<span id="cb25-10"><a href="#cb25-10"></a><span class="dv">3</span>           [<span class="dv">1</span>    <span class="dv">6</span> <span class="dv">89</span>] [     <span class="dv">6</span>  <span class="dv">9</span>] <span class="dv">4</span>           <span class="dv">7</span>           [    <span class="dv">5</span>   <span class="dv">9</span>] <span class="dv">2</span>           [    <span class="dv">56</span> <span class="dv">89</span>] [<span class="dv">1</span>   <span class="dv">56</span> <span class="dv">89</span>]</span>
<span id="cb25-11"><a href="#cb25-11"></a>[ <span class="dv">2</span>    <span class="dv">789</span>] <span class="dv">5</span>           [ <span class="dv">2</span> <span class="dv">4</span> <span class="dv">67</span> <span class="dv">9</span>] <span class="dv">1</span>           [ <span class="dv">23</span>      ] [ <span class="dv">23</span>     <span class="dv">9</span>] [     <span class="dv">6789</span>] [  <span class="dv">34</span> <span class="dv">6789</span>] [  <span class="dv">34</span> <span class="dv">6</span> <span class="dv">89</span>]</span>
<span id="cb25-12"><a href="#cb25-12"></a>[<span class="dv">12</span>    <span class="dv">7</span> <span class="dv">9</span>] [<span class="dv">1</span>  <span class="dv">4</span>  <span class="dv">7</span> <span class="dv">9</span>] [ <span class="dv">2</span> <span class="dv">4</span>  <span class="dv">7</span> <span class="dv">9</span>] <span class="dv">8</span>           [ <span class="dv">23</span>      ] <span class="dv">6</span>           [<span class="dv">1</span>   <span class="dv">5</span> <span class="dv">7</span> <span class="dv">9</span>] [  <span class="dv">345</span> <span class="dv">7</span> <span class="dv">9</span>] [<span class="dv">1</span> <span class="dv">345</span>   <span class="dv">9</span>]</span></code></pre></div>


<p>We see that <code>7</code> in the row-7-column-5 cell is eliminated from all its neighboring cells. We can’t prune the grid anymore. Now it is time to make the choice.</p>


<h2 id="making-the-choice" data-track-content data-content-name="making-the-choice" data-content-piece="fast-sudoku-solver-in-haskell-1">Making the Choice<a href="#making-the-choice" class="ref-link"></a><a href="#top" class="top-link" title="Back to top"></a></h2>


<p>One the grid is settled, we need to choose a non-fixed cell and make it fixed by assuming one of its possible values. This gives us two grids, next in the state-space of the solution search:</p>


<ul>
<li>one which has this chosen cell fixed to this chosen digit, and,</li>
<li>the other in which the chosen cell has all the other possibilities except the one we chose to fix.</li>
</ul>


<p>We call this function, <code>nextGrids</code>:</p>


<div class="sourceCode" id="cb26"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb26-1"><a href="#cb26-1"></a><span class="ot">nextGrids ::</span> <span class="dt">Grid</span> <span class="ot">-&gt;</span> (<span class="dt">Grid</span>, <span class="dt">Grid</span>)</span>
<span id="cb26-2"><a href="#cb26-2"></a>nextGrids grid <span class="ot">=</span></span>
<span id="cb26-3"><a href="#cb26-3"></a>  <span class="kw">let</span> (i, first<span class="op">@</span>(<span class="dt">Fixed</span> _), rest) <span class="ot">=</span></span>
<span id="cb26-4"><a href="#cb26-4"></a>        fixCell</span>
<span id="cb26-5"><a href="#cb26-5"></a>        <span class="op">.</span> Data.List.minimumBy (<span class="fu">compare</span> <span class="ot">`Data.Function.on`</span> (possibilityCount <span class="op">.</span> <span class="fu">snd</span>))</span>
<span id="cb26-6"><a href="#cb26-6"></a>        <span class="op">.</span> <span class="fu">filter</span> (isPossible <span class="op">.</span> <span class="fu">snd</span>)</span>
<span id="cb26-7"><a href="#cb26-7"></a>        <span class="op">.</span> <span class="fu">zip</span> [<span class="dv">0</span><span class="op">..</span>]</span>
<span id="cb26-8"><a href="#cb26-8"></a>        <span class="op">.</span> <span class="fu">concat</span></span>
<span id="cb26-9"><a href="#cb26-9"></a>        <span class="op">$</span> grid</span>
<span id="cb26-10"><a href="#cb26-10"></a>  <span class="kw">in</span> (replace2D i first grid, replace2D i rest grid)</span>
<span id="cb26-11"><a href="#cb26-11"></a>  <span class="kw">where</span></span>
<span id="cb26-12"><a href="#cb26-12"></a>    isPossible (<span class="dt">Possible</span> _) <span class="ot">=</span> <span class="dt">True</span></span>
<span id="cb26-13"><a href="#cb26-13"></a>    isPossible _            <span class="ot">=</span> <span class="dt">False</span></span>
<span id="cb26-14"><a href="#cb26-14"></a></span>
<span id="cb26-15"><a href="#cb26-15"></a>    possibilityCount (<span class="dt">Possible</span> xs) <span class="ot">=</span> <span class="fu">length</span> xs</span>
<span id="cb26-16"><a href="#cb26-16"></a>    possibilityCount (<span class="dt">Fixed</span> _)     <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb26-17"><a href="#cb26-17"></a></span>
<span id="cb26-18"><a href="#cb26-18"></a>    fixCell (i, <span class="dt">Possible</span> [x, y]) <span class="ot">=</span> (i, <span class="dt">Fixed</span> x, <span class="dt">Fixed</span> y)</span>
<span id="cb26-19"><a href="#cb26-19"></a>    fixCell (i, <span class="dt">Possible</span> (x<span class="op">:</span>xs)) <span class="ot">=</span> (i, <span class="dt">Fixed</span> x, <span class="dt">Possible</span> xs)</span>
<span id="cb26-20"><a href="#cb26-20"></a>    fixCell _                    <span class="ot">=</span> <span class="fu">error</span> <span class="st">&quot;Impossible case&quot;</span></span>
<span id="cb26-21"><a href="#cb26-21"></a></span>
<span id="cb26-22"><a href="#cb26-22"></a><span class="ot">    replace2D ::</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> [[a]] <span class="ot">-&gt;</span> [[a]]</span>
<span id="cb26-23"><a href="#cb26-23"></a>    replace2D i v <span class="ot">=</span></span>
<span id="cb26-24"><a href="#cb26-24"></a>      <span class="kw">let</span> (x, y) <span class="ot">=</span> (i <span class="ot">`quot`</span> <span class="dv">9</span>, i <span class="ot">`mod`</span> <span class="dv">9</span>) <span class="kw">in</span> replace x (replace y (<span class="fu">const</span> v))</span>
<span id="cb26-25"><a href="#cb26-25"></a>    replace p f xs <span class="ot">=</span> [<span class="kw">if</span> i <span class="op">==</span> p <span class="kw">then</span> f x <span class="kw">else</span> x <span class="op">|</span> (x, i) <span class="ot">&lt;-</span> <span class="fu">zip</span> xs [<span class="dv">0</span><span class="op">..</span>]]</span></code></pre></div>


<p>We choose the non-fixed cell with least count of possibilities as the pivot. This strategy make sense intuitively, as with a cell with fewest possibilities, we have the most chance of being right when assuming one. Fixing a non-fixed cell leads to one of the two cases:</p>


<ol type="a">
<li>the cell has only two possible values, resulting in two fixed cells, or,</li>
<li>the cell has more than two possible values, resulting in one fixed and one non-fixed cell.</li>
</ol>


<p>Then all we are left with is replacing the non-fixed cell with its fixed and fixed/non-fixed choices, which we do with some math and some list traversal. A quick check on the <em>REPL</em>:</p>


<div class="sourceCode" id="cb27"><pre class="sourceCode small haskell overflow"><code class="sourceCode haskell"><span id="cb27-1"><a href="#cb27-1"></a><span class="op">*</span><span class="dt">Main</span><span class="op">&gt;</span> <span class="dt">Just</span> grid <span class="ot">=</span> readGrid <span class="st">&quot;6......1.4.........2...........5.4.7..8...3....1.9....3..4..2...5.1........8.6...&quot;</span></span>
<span id="cb27-2"><a href="#cb27-2"></a><span class="op">*</span><span class="dt">Main</span><span class="op">&gt;</span> <span class="dt">Just</span> grid' <span class="ot">=</span> pruneGrid grid</span>
<span id="cb27-3"><a href="#cb27-3"></a><span class="op">*</span><span class="dt">Main</span><span class="op">&gt;</span> <span class="fu">putStr</span> <span class="op">$</span> showGridWithPossibilities grid'</span>
<span id="cb27-4"><a href="#cb27-4"></a><span class="dv">6</span>           [  <span class="dv">3</span>   <span class="dv">789</span>] [  <span class="dv">3</span> <span class="dv">5</span> <span class="dv">7</span> <span class="dv">9</span>] [ <span class="dv">23</span> <span class="dv">5</span> <span class="dv">7</span> <span class="dv">9</span>] [ <span class="dv">234</span>   <span class="dv">8</span> ] [ <span class="dv">2345</span> <span class="dv">789</span>] [    <span class="dv">5</span> <span class="dv">789</span>] <span class="dv">1</span>           [ <span class="dv">2345</span>  <span class="dv">89</span>]</span>
<span id="cb27-5"><a href="#cb27-5"></a><span class="dv">4</span>           [<span class="dv">1</span> <span class="dv">3</span>   <span class="dv">789</span>] [  <span class="dv">3</span> <span class="dv">5</span> <span class="dv">7</span> <span class="dv">9</span>] [ <span class="dv">23</span> <span class="dv">567</span> <span class="dv">9</span>] [<span class="dv">123</span>  <span class="dv">6</span> <span class="dv">8</span> ] [<span class="dv">123</span> <span class="dv">5</span> <span class="dv">789</span>] [    <span class="dv">56789</span>] [ <span class="dv">23</span> <span class="dv">56789</span>] [ <span class="dv">23</span> <span class="dv">56</span> <span class="dv">89</span>]</span>
<span id="cb27-6"><a href="#cb27-6"></a>[<span class="dv">1</span>   <span class="dv">5</span> <span class="dv">789</span>] <span class="dv">2</span>           [  <span class="dv">3</span> <span class="dv">5</span> <span class="dv">7</span> <span class="dv">9</span>] [  <span class="dv">3</span> <span class="dv">567</span> <span class="dv">9</span>] [<span class="dv">1</span> <span class="dv">34</span> <span class="dv">6</span> <span class="dv">8</span> ] [<span class="dv">1</span> <span class="dv">345</span> <span class="dv">789</span>] [    <span class="dv">56789</span>] [  <span class="dv">3456789</span>] [  <span class="dv">3456</span> <span class="dv">89</span>]</span>
<span id="cb27-7"><a href="#cb27-7"></a>[ <span class="dv">2</span>      <span class="dv">9</span>] [  <span class="dv">3</span>  <span class="dv">6</span>  <span class="dv">9</span>] [ <span class="dv">23</span>  <span class="dv">6</span>  <span class="dv">9</span>] [ <span class="dv">23</span>  <span class="dv">6</span>   ] <span class="dv">5</span>           [<span class="dv">123</span>    <span class="dv">8</span> ] <span class="dv">4</span>           [ <span class="dv">2</span>   <span class="dv">6</span> <span class="dv">89</span>] <span class="dv">7</span></span>
<span id="cb27-8"><a href="#cb27-8"></a>[ <span class="dv">2</span>  <span class="dv">5</span> <span class="dv">7</span> <span class="dv">9</span>] [   <span class="dv">4</span> <span class="dv">67</span> <span class="dv">9</span>] <span class="dv">8</span>           [ <span class="dv">2</span>   <span class="dv">67</span>  ] [<span class="dv">12</span> <span class="dv">4</span> <span class="dv">6</span>   ] [<span class="dv">12</span> <span class="dv">4</span>  <span class="dv">7</span>  ] <span class="dv">3</span>           [ <span class="dv">2</span>  <span class="dv">56</span>  <span class="dv">9</span>] [<span class="dv">12</span>  <span class="dv">56</span>  <span class="dv">9</span>]</span>
<span id="cb27-9"><a href="#cb27-9"></a>[ <span class="dv">2</span>  <span class="dv">5</span> <span class="dv">7</span>  ] [  <span class="dv">34</span> <span class="dv">67</span>  ] <span class="dv">1</span>           [ <span class="dv">23</span>  <span class="dv">67</span>  ] <span class="dv">9</span>           [ <span class="dv">234</span>  <span class="dv">78</span> ] [    <span class="dv">56</span> <span class="dv">8</span> ] [ <span class="dv">2</span>  <span class="dv">56</span> <span class="dv">8</span> ] [ <span class="dv">2</span>  <span class="dv">56</span> <span class="dv">8</span> ]</span>
<span id="cb27-10"><a href="#cb27-10"></a><span class="dv">3</span>           [<span class="dv">1</span>    <span class="dv">6</span> <span class="dv">89</span>] [     <span class="dv">6</span>  <span class="dv">9</span>] <span class="dv">4</span>           <span class="dv">7</span>           [    <span class="dv">5</span>   <span class="dv">9</span>] <span class="dv">2</span>           [    <span class="dv">56</span> <span class="dv">89</span>] [<span class="dv">1</span>   <span class="dv">56</span> <span class="dv">89</span>]</span>
<span id="cb27-11"><a href="#cb27-11"></a>[ <span class="dv">2</span>    <span class="dv">789</span>] <span class="dv">5</span>           [ <span class="dv">2</span> <span class="dv">4</span> <span class="dv">67</span> <span class="dv">9</span>] <span class="dv">1</span>           [ <span class="dv">23</span>      ] [ <span class="dv">23</span>     <span class="dv">9</span>] [     <span class="dv">6789</span>] [  <span class="dv">34</span> <span class="dv">6789</span>] [  <span class="dv">34</span> <span class="dv">6</span> <span class="dv">89</span>]</span>
<span id="cb27-12"><a href="#cb27-12"></a>[<span class="dv">12</span>    <span class="dv">7</span> <span class="dv">9</span>] [<span class="dv">1</span>  <span class="dv">4</span>  <span class="dv">7</span> <span class="dv">9</span>] [ <span class="dv">2</span> <span class="dv">4</span>  <span class="dv">7</span> <span class="dv">9</span>] <span class="dv">8</span>           [ <span class="dv">23</span>      ] <span class="dv">6</span>           [<span class="dv">1</span>   <span class="dv">5</span> <span class="dv">7</span> <span class="dv">9</span>] [  <span class="dv">345</span> <span class="dv">7</span> <span class="dv">9</span>] [<span class="dv">1</span> <span class="dv">345</span>   <span class="dv">9</span>]</span>
<span id="cb27-13"><a href="#cb27-13"></a><span class="op">*</span><span class="dt">Main</span><span class="op">&gt;</span> <span class="co">-- the row-4-column-1 cell is the first cell with only two possibilities, [2, 9].</span></span>
<span id="cb27-14"><a href="#cb27-14"></a><span class="op">*</span><span class="dt">Main</span><span class="op">&gt;</span> <span class="co">-- it is chosen as the pivot cell to find the next grids.</span></span>
<span id="cb27-15"><a href="#cb27-15"></a><span class="op">*</span><span class="dt">Main</span><span class="op">&gt;</span> (grid1, grid2) <span class="ot">=</span> nextGrids grid'</span>
<span id="cb27-16"><a href="#cb27-16"></a><span class="op">*</span><span class="dt">Main</span><span class="op">&gt;</span> <span class="fu">putStr</span> <span class="op">$</span> showGridWithPossibilities grid1</span>
<span id="cb27-17"><a href="#cb27-17"></a><span class="dv">6</span>           [  <span class="dv">3</span>   <span class="dv">789</span>] [  <span class="dv">3</span> <span class="dv">5</span> <span class="dv">7</span> <span class="dv">9</span>] [ <span class="dv">23</span> <span class="dv">5</span> <span class="dv">7</span> <span class="dv">9</span>] [ <span class="dv">234</span>   <span class="dv">8</span> ] [ <span class="dv">2345</span> <span class="dv">789</span>] [    <span class="dv">5</span> <span class="dv">789</span>] <span class="dv">1</span>           [ <span class="dv">2345</span>  <span class="dv">89</span>]</span>
<span id="cb27-18"><a href="#cb27-18"></a><span class="dv">4</span>           [<span class="dv">1</span> <span class="dv">3</span>   <span class="dv">789</span>] [  <span class="dv">3</span> <span class="dv">5</span> <span class="dv">7</span> <span class="dv">9</span>] [ <span class="dv">23</span> <span class="dv">567</span> <span class="dv">9</span>] [<span class="dv">123</span>  <span class="dv">6</span> <span class="dv">8</span> ] [<span class="dv">123</span> <span class="dv">5</span> <span class="dv">789</span>] [    <span class="dv">56789</span>] [ <span class="dv">23</span> <span class="dv">56789</span>] [ <span class="dv">23</span> <span class="dv">56</span> <span class="dv">89</span>]</span>
<span id="cb27-19"><a href="#cb27-19"></a>[<span class="dv">1</span>   <span class="dv">5</span> <span class="dv">789</span>] <span class="dv">2</span>           [  <span class="dv">3</span> <span class="dv">5</span> <span class="dv">7</span> <span class="dv">9</span>] [  <span class="dv">3</span> <span class="dv">567</span> <span class="dv">9</span>] [<span class="dv">1</span> <span class="dv">34</span> <span class="dv">6</span> <span class="dv">8</span> ] [<span class="dv">1</span> <span class="dv">345</span> <span class="dv">789</span>] [    <span class="dv">56789</span>] [  <span class="dv">3456789</span>] [  <span class="dv">3456</span> <span class="dv">89</span>]</span>
<span id="cb27-20"><a href="#cb27-20"></a><span class="dv">2</span>           [  <span class="dv">3</span>  <span class="dv">6</span>  <span class="dv">9</span>] [ <span class="dv">23</span>  <span class="dv">6</span>  <span class="dv">9</span>] [ <span class="dv">23</span>  <span class="dv">6</span>   ] <span class="dv">5</span>           [<span class="dv">123</span>    <span class="dv">8</span> ] <span class="dv">4</span>           [ <span class="dv">2</span>   <span class="dv">6</span> <span class="dv">89</span>] <span class="dv">7</span></span>
<span id="cb27-21"><a href="#cb27-21"></a>[ <span class="dv">2</span>  <span class="dv">5</span> <span class="dv">7</span> <span class="dv">9</span>] [   <span class="dv">4</span> <span class="dv">67</span> <span class="dv">9</span>] <span class="dv">8</span>           [ <span class="dv">2</span>   <span class="dv">67</span>  ] [<span class="dv">12</span> <span class="dv">4</span> <span class="dv">6</span>   ] [<span class="dv">12</span> <span class="dv">4</span>  <span class="dv">7</span>  ] <span class="dv">3</span>           [ <span class="dv">2</span>  <span class="dv">56</span>  <span class="dv">9</span>] [<span class="dv">12</span>  <span class="dv">56</span>  <span class="dv">9</span>]</span>
<span id="cb27-22"><a href="#cb27-22"></a>[ <span class="dv">2</span>  <span class="dv">5</span> <span class="dv">7</span>  ] [  <span class="dv">34</span> <span class="dv">67</span>  ] <span class="dv">1</span>           [ <span class="dv">23</span>  <span class="dv">67</span>  ] <span class="dv">9</span>           [ <span class="dv">234</span>  <span class="dv">78</span> ] [    <span class="dv">56</span> <span class="dv">8</span> ] [ <span class="dv">2</span>  <span class="dv">56</span> <span class="dv">8</span> ] [ <span class="dv">2</span>  <span class="dv">56</span> <span class="dv">8</span> ]</span>
<span id="cb27-23"><a href="#cb27-23"></a><span class="dv">3</span>           [<span class="dv">1</span>    <span class="dv">6</span> <span class="dv">89</span>] [     <span class="dv">6</span>  <span class="dv">9</span>] <span class="dv">4</span>           <span class="dv">7</span>           [    <span class="dv">5</span>   <span class="dv">9</span>] <span class="dv">2</span>           [    <span class="dv">56</span> <span class="dv">89</span>] [<span class="dv">1</span>   <span class="dv">56</span> <span class="dv">89</span>]</span>
<span id="cb27-24"><a href="#cb27-24"></a>[ <span class="dv">2</span>    <span class="dv">789</span>] <span class="dv">5</span>           [ <span class="dv">2</span> <span class="dv">4</span> <span class="dv">67</span> <span class="dv">9</span>] <span class="dv">1</span>           [ <span class="dv">23</span>      ] [ <span class="dv">23</span>     <span class="dv">9</span>] [     <span class="dv">6789</span>] [  <span class="dv">34</span> <span class="dv">6789</span>] [  <span class="dv">34</span> <span class="dv">6</span> <span class="dv">89</span>]</span>
<span id="cb27-25"><a href="#cb27-25"></a>[<span class="dv">12</span>    <span class="dv">7</span> <span class="dv">9</span>] [<span class="dv">1</span>  <span class="dv">4</span>  <span class="dv">7</span> <span class="dv">9</span>] [ <span class="dv">2</span> <span class="dv">4</span>  <span class="dv">7</span> <span class="dv">9</span>] <span class="dv">8</span>           [ <span class="dv">23</span>      ] <span class="dv">6</span>           [<span class="dv">1</span>   <span class="dv">5</span> <span class="dv">7</span> <span class="dv">9</span>] [  <span class="dv">345</span> <span class="dv">7</span> <span class="dv">9</span>] [<span class="dv">1</span> <span class="dv">345</span>   <span class="dv">9</span>]</span>
<span id="cb27-26"><a href="#cb27-26"></a><span class="op">*</span><span class="dt">Main</span><span class="op">&gt;</span> <span class="fu">putStr</span> <span class="op">$</span> showGridWithPossibilities grid2</span>
<span id="cb27-27"><a href="#cb27-27"></a><span class="dv">6</span>           [  <span class="dv">3</span>   <span class="dv">789</span>] [  <span class="dv">3</span> <span class="dv">5</span> <span class="dv">7</span> <span class="dv">9</span>] [ <span class="dv">23</span> <span class="dv">5</span> <span class="dv">7</span> <span class="dv">9</span>] [ <span class="dv">234</span>   <span class="dv">8</span> ] [ <span class="dv">2345</span> <span class="dv">789</span>] [    <span class="dv">5</span> <span class="dv">789</span>] <span class="dv">1</span>           [ <span class="dv">2345</span>  <span class="dv">89</span>]</span>
<span id="cb27-28"><a href="#cb27-28"></a><span class="dv">4</span>           [<span class="dv">1</span> <span class="dv">3</span>   <span class="dv">789</span>] [  <span class="dv">3</span> <span class="dv">5</span> <span class="dv">7</span> <span class="dv">9</span>] [ <span class="dv">23</span> <span class="dv">567</span> <span class="dv">9</span>] [<span class="dv">123</span>  <span class="dv">6</span> <span class="dv">8</span> ] [<span class="dv">123</span> <span class="dv">5</span> <span class="dv">789</span>] [    <span class="dv">56789</span>] [ <span class="dv">23</span> <span class="dv">56789</span>] [ <span class="dv">23</span> <span class="dv">56</span> <span class="dv">89</span>]</span>
<span id="cb27-29"><a href="#cb27-29"></a>[<span class="dv">1</span>   <span class="dv">5</span> <span class="dv">789</span>] <span class="dv">2</span>           [  <span class="dv">3</span> <span class="dv">5</span> <span class="dv">7</span> <span class="dv">9</span>] [  <span class="dv">3</span> <span class="dv">567</span> <span class="dv">9</span>] [<span class="dv">1</span> <span class="dv">34</span> <span class="dv">6</span> <span class="dv">8</span> ] [<span class="dv">1</span> <span class="dv">345</span> <span class="dv">789</span>] [    <span class="dv">56789</span>] [  <span class="dv">3456789</span>] [  <span class="dv">3456</span> <span class="dv">89</span>]</span>
<span id="cb27-30"><a href="#cb27-30"></a><span class="dv">9</span>           [  <span class="dv">3</span>  <span class="dv">6</span>  <span class="dv">9</span>] [ <span class="dv">23</span>  <span class="dv">6</span>  <span class="dv">9</span>] [ <span class="dv">23</span>  <span class="dv">6</span>   ] <span class="dv">5</span>           [<span class="dv">123</span>    <span class="dv">8</span> ] <span class="dv">4</span>           [ <span class="dv">2</span>   <span class="dv">6</span> <span class="dv">89</span>] <span class="dv">7</span></span>
<span id="cb27-31"><a href="#cb27-31"></a>[ <span class="dv">2</span>  <span class="dv">5</span> <span class="dv">7</span> <span class="dv">9</span>] [   <span class="dv">4</span> <span class="dv">67</span> <span class="dv">9</span>] <span class="dv">8</span>           [ <span class="dv">2</span>   <span class="dv">67</span>  ] [<span class="dv">12</span> <span class="dv">4</span> <span class="dv">6</span>   ] [<span class="dv">12</span> <span class="dv">4</span>  <span class="dv">7</span>  ] <span class="dv">3</span>           [ <span class="dv">2</span>  <span class="dv">56</span>  <span class="dv">9</span>] [<span class="dv">12</span>  <span class="dv">56</span>  <span class="dv">9</span>]</span>
<span id="cb27-32"><a href="#cb27-32"></a>[ <span class="dv">2</span>  <span class="dv">5</span> <span class="dv">7</span>  ] [  <span class="dv">34</span> <span class="dv">67</span>  ] <span class="dv">1</span>           [ <span class="dv">23</span>  <span class="dv">67</span>  ] <span class="dv">9</span>           [ <span class="dv">234</span>  <span class="dv">78</span> ] [    <span class="dv">56</span> <span class="dv">8</span> ] [ <span class="dv">2</span>  <span class="dv">56</span> <span class="dv">8</span> ] [ <span class="dv">2</span>  <span class="dv">56</span> <span class="dv">8</span> ]</span>
<span id="cb27-33"><a href="#cb27-33"></a><span class="dv">3</span>           [<span class="dv">1</span>    <span class="dv">6</span> <span class="dv">89</span>] [     <span class="dv">6</span>  <span class="dv">9</span>] <span class="dv">4</span>           <span class="dv">7</span>           [    <span class="dv">5</span>   <span class="dv">9</span>] <span class="dv">2</span>           [    <span class="dv">56</span> <span class="dv">89</span>] [<span class="dv">1</span>   <span class="dv">56</span> <span class="dv">89</span>]</span>
<span id="cb27-34"><a href="#cb27-34"></a>[ <span class="dv">2</span>    <span class="dv">789</span>] <span class="dv">5</span>           [ <span class="dv">2</span> <span class="dv">4</span> <span class="dv">67</span> <span class="dv">9</span>] <span class="dv">1</span>           [ <span class="dv">23</span>      ] [ <span class="dv">23</span>     <span class="dv">9</span>] [     <span class="dv">6789</span>] [  <span class="dv">34</span> <span class="dv">6789</span>] [  <span class="dv">34</span> <span class="dv">6</span> <span class="dv">89</span>]</span>
<span id="cb27-35"><a href="#cb27-35"></a>[<span class="dv">12</span>    <span class="dv">7</span> <span class="dv">9</span>] [<span class="dv">1</span>  <span class="dv">4</span>  <span class="dv">7</span> <span class="dv">9</span>] [ <span class="dv">2</span> <span class="dv">4</span>  <span class="dv">7</span> <span class="dv">9</span>] <span class="dv">8</span>           [ <span class="dv">23</span>      ] <span class="dv">6</span>           [<span class="dv">1</span>   <span class="dv">5</span> <span class="dv">7</span> <span class="dv">9</span>] [  <span class="dv">345</span> <span class="dv">7</span> <span class="dv">9</span>] [<span class="dv">1</span> <span class="dv">345</span>   <span class="dv">9</span>]</span></code></pre></div>


<h2 id="solving-the-puzzle" data-track-content data-content-name="solving-the-puzzle" data-content-piece="fast-sudoku-solver-in-haskell-1">Solving the Puzzle<a href="#solving-the-puzzle" class="ref-link"></a><a href="#top" class="top-link" title="Back to top"></a></h2>


<p>We have implemented parts of our algorithm till now. Now we’ll put everything together to solve the puzzle. First, we need to know if we are done or have messed up:</p>


<div class="sourceCode" id="cb28"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb28-1"><a href="#cb28-1"></a><span class="ot">isGridFilled ::</span> <span class="dt">Grid</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span></span>
<span id="cb28-2"><a href="#cb28-2"></a>isGridFilled grid <span class="ot">=</span> <span class="fu">null</span> [ () <span class="op">|</span> <span class="dt">Possible</span> _ <span class="ot">&lt;-</span> <span class="fu">concat</span> grid ]</span>
<span id="cb28-3"><a href="#cb28-3"></a></span>
<span id="cb28-4"><a href="#cb28-4"></a><span class="ot">isGridInvalid ::</span> <span class="dt">Grid</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span></span>
<span id="cb28-5"><a href="#cb28-5"></a>isGridInvalid grid <span class="ot">=</span></span>
<span id="cb28-6"><a href="#cb28-6"></a>  <span class="fu">any</span> isInvalidRow grid</span>
<span id="cb28-7"><a href="#cb28-7"></a>  <span class="op">||</span> <span class="fu">any</span> isInvalidRow (Data.List.transpose grid)</span>
<span id="cb28-8"><a href="#cb28-8"></a>  <span class="op">||</span> <span class="fu">any</span> isInvalidRow (subGridsToRows grid)</span>
<span id="cb28-9"><a href="#cb28-9"></a>  <span class="kw">where</span></span>
<span id="cb28-10"><a href="#cb28-10"></a>    isInvalidRow row <span class="ot">=</span></span>
<span id="cb28-11"><a href="#cb28-11"></a>      <span class="kw">let</span> fixeds         <span class="ot">=</span> [x <span class="op">|</span> <span class="dt">Fixed</span> x <span class="ot">&lt;-</span> row]</span>
<span id="cb28-12"><a href="#cb28-12"></a>          emptyPossibles <span class="ot">=</span> [x <span class="op">|</span> <span class="dt">Possible</span> x <span class="ot">&lt;-</span> row, <span class="fu">null</span> x]</span>
<span id="cb28-13"><a href="#cb28-13"></a>      <span class="kw">in</span> hasDups fixeds <span class="op">||</span> <span class="fu">not</span> (<span class="fu">null</span> emptyPossibles)</span>
<span id="cb28-14"><a href="#cb28-14"></a></span>
<span id="cb28-15"><a href="#cb28-15"></a>    hasDups l <span class="ot">=</span> hasDups' l []</span>
<span id="cb28-16"><a href="#cb28-16"></a></span>
<span id="cb28-17"><a href="#cb28-17"></a>    hasDups' [] _ <span class="ot">=</span> <span class="dt">False</span></span>
<span id="cb28-18"><a href="#cb28-18"></a>    hasDups' (y<span class="op">:</span>ys) xs</span>
<span id="cb28-19"><a href="#cb28-19"></a>      <span class="op">|</span> y <span class="ot">`elem`</span> xs <span class="ot">=</span> <span class="dt">True</span></span>
<span id="cb28-20"><a href="#cb28-20"></a>      <span class="op">|</span> <span class="fu">otherwise</span>   <span class="ot">=</span> hasDups' ys (y<span class="op">:</span>xs)</span></code></pre></div>


<p><code>isGridFilled</code> returns whether a grid is filled completely by checking it for any <code>Possible</code> cells. <code>isGridInvalid</code> checks if a grid is invalid because it either has duplicate fixed cells in any block or has any non-fixed cell with no possibilities.</p>


<p>Writing the <code>solve</code> function is almost trivial now:</p>


<div class="sourceCode" id="cb29"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb29-1"><a href="#cb29-1"></a><span class="ot">solve ::</span> <span class="dt">Grid</span> <span class="ot">-&gt;</span> <span class="dt">Maybe</span> <span class="dt">Grid</span></span>
<span id="cb29-2"><a href="#cb29-2"></a>solve grid <span class="ot">=</span> pruneGrid grid <span class="op">&gt;&gt;=</span> solve'</span>
<span id="cb29-3"><a href="#cb29-3"></a>  <span class="kw">where</span></span>
<span id="cb29-4"><a href="#cb29-4"></a>    solve' g</span>
<span id="cb29-5"><a href="#cb29-5"></a>      <span class="op">|</span> isGridInvalid g <span class="ot">=</span> <span class="dt">Nothing</span></span>
<span id="cb29-6"><a href="#cb29-6"></a>      <span class="op">|</span> isGridFilled g  <span class="ot">=</span> <span class="dt">Just</span> g</span>
<span id="cb29-7"><a href="#cb29-7"></a>      <span class="op">|</span> <span class="fu">otherwise</span>       <span class="ot">=</span></span>
<span id="cb29-8"><a href="#cb29-8"></a>          <span class="kw">let</span> (grid1, grid2) <span class="ot">=</span> nextGrids g</span>
<span id="cb29-9"><a href="#cb29-9"></a>          <span class="kw">in</span> solve grid1 <span class="op">&lt;|&gt;</span> solve grid2</span></code></pre></div>


<p>We prune the grid as before and pipe it to the helper function <code>solve'</code>. <code>solve'</code> bails with a <code>Nothing</code> if the grid is invalid, or returns the solved grid if it is filled completely. Otherwise, it finds the next two grids in the search tree and solves them recursively with backtracking by calling the <code>solve</code> function. Backtracking here is implemented by the using the <a href="https://hackage.haskell.org/package/base-4.11.1.0/docs/Control-Applicative.html#g:2" target="_blank" rel="noopener"><code>Alternative</code></a> (<code>&lt;|&gt;</code>) implementation of the <code>Maybe</code> type<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>. It takes the second branch in the computation if the first branch returns a <code>Nothing</code>.</p>


<p>Whew! That took us long. Let’s put it to the final test now:</p>


<div class="sourceCode" id="cb31"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb31-1"><a href="#cb31-1"></a><span class="op">*</span><span class="dt">Main</span><span class="op">&gt;</span> <span class="dt">Just</span> grid <span class="ot">=</span></span>
<span id="cb31-2"><a href="#cb31-2"></a>  readGrid <span class="st">&quot;6......1.4.........2...........5.4.7..8...3....1.9....3..4..2...5.1........8.6...&quot;</span></span>
<span id="cb31-3"><a href="#cb31-3"></a><span class="op">*</span><span class="dt">Main</span><span class="op">&gt;</span> <span class="fu">putStr</span> <span class="op">$</span> showGrid grid</span>
<span id="cb31-4"><a href="#cb31-4"></a><span class="dv">6</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="dv">1</span> <span class="op">.</span></span>
<span id="cb31-5"><a href="#cb31-5"></a><span class="dv">4</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span></span>
<span id="cb31-6"><a href="#cb31-6"></a><span class="op">.</span> <span class="dv">2</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span></span>
<span id="cb31-7"><a href="#cb31-7"></a><span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="dv">5</span> <span class="op">.</span> <span class="dv">4</span> <span class="op">.</span> <span class="dv">7</span></span>
<span id="cb31-8"><a href="#cb31-8"></a><span class="op">.</span> <span class="op">.</span> <span class="dv">8</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="dv">3</span> <span class="op">.</span> <span class="op">.</span></span>
<span id="cb31-9"><a href="#cb31-9"></a><span class="op">.</span> <span class="op">.</span> <span class="dv">1</span> <span class="op">.</span> <span class="dv">9</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span></span>
<span id="cb31-10"><a href="#cb31-10"></a><span class="dv">3</span> <span class="op">.</span> <span class="op">.</span> <span class="dv">4</span> <span class="op">.</span> <span class="op">.</span> <span class="dv">2</span> <span class="op">.</span> <span class="op">.</span></span>
<span id="cb31-11"><a href="#cb31-11"></a><span class="op">.</span> <span class="dv">5</span> <span class="op">.</span> <span class="dv">1</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span></span>
<span id="cb31-12"><a href="#cb31-12"></a><span class="op">.</span> <span class="op">.</span> <span class="op">.</span> <span class="dv">8</span> <span class="op">.</span> <span class="dv">6</span> <span class="op">.</span> <span class="op">.</span> <span class="op">.</span></span>
<span id="cb31-13"><a href="#cb31-13"></a><span class="op">*</span><span class="dt">Main</span><span class="op">&gt;</span> <span class="dt">Just</span> grid' <span class="ot">=</span> solve grid</span>
<span id="cb31-14"><a href="#cb31-14"></a><span class="op">*</span><span class="dt">Main</span><span class="op">&gt;</span> <span class="fu">putStr</span> <span class="op">$</span> showGrid grid'</span>
<span id="cb31-15"><a href="#cb31-15"></a><span class="dv">6</span> <span class="dv">9</span> <span class="dv">3</span> <span class="dv">7</span> <span class="dv">8</span> <span class="dv">4</span> <span class="dv">5</span> <span class="dv">1</span> <span class="dv">2</span></span>
<span id="cb31-16"><a href="#cb31-16"></a><span class="dv">4</span> <span class="dv">8</span> <span class="dv">7</span> <span class="dv">5</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">9</span> <span class="dv">3</span> <span class="dv">6</span></span>
<span id="cb31-17"><a href="#cb31-17"></a><span class="dv">1</span> <span class="dv">2</span> <span class="dv">5</span> <span class="dv">9</span> <span class="dv">6</span> <span class="dv">3</span> <span class="dv">8</span> <span class="dv">7</span> <span class="dv">4</span></span>
<span id="cb31-18"><a href="#cb31-18"></a><span class="dv">9</span> <span class="dv">3</span> <span class="dv">2</span> <span class="dv">6</span> <span class="dv">5</span> <span class="dv">1</span> <span class="dv">4</span> <span class="dv">8</span> <span class="dv">7</span></span>
<span id="cb31-19"><a href="#cb31-19"></a><span class="dv">5</span> <span class="dv">6</span> <span class="dv">8</span> <span class="dv">2</span> <span class="dv">4</span> <span class="dv">7</span> <span class="dv">3</span> <span class="dv">9</span> <span class="dv">1</span></span>
<span id="cb31-20"><a href="#cb31-20"></a><span class="dv">7</span> <span class="dv">4</span> <span class="dv">1</span> <span class="dv">3</span> <span class="dv">9</span> <span class="dv">8</span> <span class="dv">6</span> <span class="dv">2</span> <span class="dv">5</span></span>
<span id="cb31-21"><a href="#cb31-21"></a><span class="dv">3</span> <span class="dv">1</span> <span class="dv">9</span> <span class="dv">4</span> <span class="dv">7</span> <span class="dv">5</span> <span class="dv">2</span> <span class="dv">6</span> <span class="dv">8</span></span>
<span id="cb31-22"><a href="#cb31-22"></a><span class="dv">8</span> <span class="dv">5</span> <span class="dv">6</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">9</span> <span class="dv">7</span> <span class="dv">4</span> <span class="dv">3</span></span>
<span id="cb31-23"><a href="#cb31-23"></a><span class="dv">2</span> <span class="dv">7</span> <span class="dv">4</span> <span class="dv">8</span> <span class="dv">3</span> <span class="dv">6</span> <span class="dv">1</span> <span class="dv">5</span> <span class="dv">9</span></span></code></pre></div>


<p>It works! Let’s put a quick <code>main</code> wrapper around <code>solve</code> to call it from the command line:</p>


<div class="sourceCode" id="cb32"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb32-1"><a href="#cb32-1"></a><span class="ot">main ::</span> <span class="dt">IO</span> ()</span>
<span id="cb32-2"><a href="#cb32-2"></a>main <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb32-3"><a href="#cb32-3"></a>  inputs <span class="ot">&lt;-</span> <span class="fu">lines</span> <span class="op">&lt;$&gt;</span> <span class="fu">getContents</span></span>
<span id="cb32-4"><a href="#cb32-4"></a>  Control.Monad.forM_ inputs <span class="op">$</span> \input <span class="ot">-&gt;</span></span>
<span id="cb32-5"><a href="#cb32-5"></a>    <span class="kw">case</span> readGrid input <span class="kw">of</span></span>
<span id="cb32-6"><a href="#cb32-6"></a>      <span class="dt">Nothing</span>   <span class="ot">-&gt;</span> <span class="fu">putStrLn</span> <span class="st">&quot;Invalid input&quot;</span></span>
<span id="cb32-7"><a href="#cb32-7"></a>      <span class="dt">Just</span> grid <span class="ot">-&gt;</span> <span class="kw">case</span> solve grid <span class="kw">of</span></span>
<span id="cb32-8"><a href="#cb32-8"></a>        <span class="dt">Nothing</span>    <span class="ot">-&gt;</span> <span class="fu">putStrLn</span> <span class="st">&quot;No solution found&quot;</span></span>
<span id="cb32-9"><a href="#cb32-9"></a>        <span class="dt">Just</span> grid' <span class="ot">-&gt;</span> <span class="fu">putStrLn</span> <span class="op">$</span> showGrid grid'</span></code></pre></div>


<p>And now, we can invoke it from the command line:</p>


<pre class="plain"><code>$ echo &quot;.......12.5.4............3.7..6..4....1..........8....92....8.....51.7.......3...&quot; | stack exec sudoku
3 6 4 9 7 8 5 1 2
1 5 2 4 3 6 9 7 8
8 7 9 1 2 5 6 3 4
7 3 8 6 5 1 4 2 9
6 9 1 2 4 7 3 8 5
2 4 5 3 8 9 1 6 7
9 2 3 7 6 4 8 5 1
4 8 6 5 1 2 7 9 3
5 1 7 8 9 3 2 4 6</code></pre>


<p>And, we are done.</p>


<p>If you want to play with different puzzles, the file <a href="https://abhinavsarkar.net/files/sudoku17.txt.bz2">here</a> lists some of the toughest ones. Let’s run<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> some of them through our program to see how fast it is:</p>


<pre class="plain"><code>$ head -n100 sudoku17.txt | time stack exec sudoku
... output omitted ...
      116.70 real       198.09 user        94.46 sys</code></pre>


<p>It took about 117 seconds to solve a hundred puzzles, so, about 1.2 seconds per puzzle. This is pretty slow but we’ll get around to making it faster in the subsequent posts.</p>


<h2 id="conclusion" data-track-content data-content-name="conclusion" data-content-piece="fast-sudoku-solver-in-haskell-1">Conclusion<a href="#conclusion" class="ref-link"></a><a href="#top" class="top-link" title="Back to top"></a></h2>


<p>In this rather verbose article, we learned how to write a simple Sudoku solver in Haskell step-by-step. In the later parts of this series, we’ll delve into profiling the solution and figuring out better algorithms and data structures to solve Sudoku more efficiently. The code till now is available <a href="https://code.abhinavsarkar.net/abhin4v/hasdoku/src/commit/0ef77341a10fcc25926301ee47b931d92959c0fa" target="_blank" rel="noopener">here</a>. Discuss this post on <a href="https://www.reddit.com/r/haskell/comments/8uapij/fast_sudoku_solver_in_haskell/" target="_blank" rel="noopener">r/haskell</a> or <a href="https://abhinavsarkar.net/posts/fast-sudoku-solver-in-haskell-1/#comment-container">leave a comment</a>.</p>


<p><section class="footnotes" role="doc-endnotes"></p>

<hr />


<ol>
<li id="fn1" role="doc-endnote"><p>This exercise was originally done as a part of <a href="https://github.com/pratul/haskell-classes/" target="_blank" rel="noopener">the</a> <a href="https://github.com/ford-prefect/haskell-classes/" target="_blank" rel="noopener">Haskell</a> <a href="https://github.com/bnvinay92/haskell-classes/" target="_blank" rel="noopener">classes</a> I taught at <a href="https://nilenso.com" target="_blank" rel="noopener">nilenso</a>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2" role="doc-endnote"><p><code>Alternative</code> implementation of <code>Maybe</code>:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb30-1"><a href="#cb30-1"></a><span class="kw">instance</span> <span class="dt">Alternative</span> <span class="dt">Maybe</span> <span class="kw">where</span></span>
<span id="cb30-2"><a href="#cb30-2"></a>  empty <span class="ot">=</span> <span class="dt">Nothing</span></span>
<span id="cb30-3"><a href="#cb30-3"></a>  <span class="dt">Nothing</span> <span class="op">&lt;|&gt;</span> r <span class="ot">=</span> r</span>
<span id="cb30-4"><a href="#cb30-4"></a>  l       <span class="op">&lt;|&gt;</span> _ <span class="ot">=</span> l</span></code></pre></div>
<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></li>
<li id="fn3" role="doc-endnote"><p>All the runs were done on my MacBook Pro from 2014 with 2.2 GHz Intel Core i7 CPU and 16 GB memory.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>


<p></section><p>If you liked this post, please <a href="https://abhinavsarkar.net/posts/fast-sudoku-solver-in-haskell-1/#comment-container">leave a comment</a>.</p><img src="https://anna.abhinavsarkar.net/piwik.php?idsite=1&amp;rec=1" style="border:0; display: none;" /><div class="author">
  <img src="https://nilenso.com/images/people/abhinav-200.png" style="width: 96px; height: 96;">
  <span style="position: absolute; padding: 32px 15px;">
    <i>Original post by <a href="http://twitter.com/abhin4v">Abhinav Sarkar</a> - check out <a href="https://abhinavsarkar.net">All posts on abhinavsarkar.net</a></i>
  </span>
</div></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
  
    
      <h1 class="entry-title"><a href="/blog/2018/05/23/finances-in-an-employee-owned-technology-co-opera/">Finances in an Employee-Owned Technology Co-operative</a></h1>
      
      
    
      <p class="meta">
        









<time datetime="2018-05-23T00:00:00+05:30" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>If you are not already familiar with <a href="https://nilenso.com">nilenso</a>, I apologize. This article may not make any sense to you. Requested as an opinion piece in reply to an internal email on salaries, it hinges on a lot of context.</p>


<p>You may find that context interesting.</p>


<ul><li>YourStory: <a href="https://yourstory.com/2017/02/nilenso-sofware-cooperative/">India’s first software co-operative</a></li><li><a href="https://yourstory.com/2017/02/nilenso-sofware-cooperative/">Huh? A Software Cooperative?</a> — an introduction</li><li><a href="https://blog.nilenso.com/blog/2015/06/30/how-to-co-op-salaries-reviews/">How to Co-op: Salaries and Reviews</a></li><li><a href="https://blog.nilenso.com/blog/2016/05/16/i-have-cramps/">“I have cramps.”</a> — introducing our menstrual leave policy</li><li><a href="https://blog.nilenso.com/blog/2017/02/14/nilenso-policies-by-the-people-for-the-people/">nilenso policies</a> — democratic corporate benefits</li><li><a href="https://blog.nilenso.com/blog/2017/04/06/black-mirror-or-a-review-of-the-review-process-at/">nilenso reviews</a> — how do we evaluate one another?</li><li><a href="https://blog.nilenso.com/blog/archives/">blog archive</a> — the rest of the articles we’ve written</li></ul>


<p>The email which spawned this discussion was from a new employee, suggesting that we raise salaries. We discuss such organizational and infrastructural changes on occasion (not often) and an open conversation is welcome.</p>


<p>However, as I’m leaving nilenso in July, it felt worthwhile to capture what would otherwise be a one-time, long-winded email to nilenso’s <em>existing</em> staff and transform that into an article which could capture one founding member’s opinion of what nilenso is, for all future staff — and other fans of Employee-owned Co-operatives—who would care to read it.</p>


<h3>On Salaries</h3>


<p>The original email had a fairly simple 3-part structure.</p>


<p><strong>First: How much can we pay?</strong> …without compromising on organizational goals like maintaining a rainy-day cash buffer and financing experimental new ventures?</p>


<p><strong>Second, a declaration of our rates &amp; salaries.</strong> Highlighted is the delta between the two. Our rates vary a lot from project to project, but for the sake of example, imagine our rates average to $100/hour. (100 is a nice round number.) At $100/hour, our rates were high for Indian software consultancies, but not astronomical. A napkin calculation roughs $100/hour to over $100,000/year in revenue. Historically, very senior people at nilenso made about half this revenue figure as salary.</p>


<blockquote>[F]or people with more experience and established reputation, there is an incentive to break away and start their own business so that they can pocket the difference.</blockquote>


<p>(All quotes are from the aforementioned email.)</p>


<p><strong>Third and last, a spectrum of starting salaries.</strong> These were listed for college grads of reputable Indian universities, such as NIT and IIT. Paymasters near the top included Uber and Goldman Sachs. Near the bottom were Samsung and American Express.</p>


<blockquote>Some of the people I know from college are very good programmers and I’ll have a very hard [time] convincing them to join Nilenso [sic], because the difference between our salaries and the industry “standard” is too large.</blockquote>


<p>….</p>


<blockquote>[M]ost of our clients can pay pretty high salaries. From their perspective it isn’t an unreasonable strategy to hire a bunch of folks from nilenso instead of negotiating our high rates</blockquote>


<p>It is possible this argument doesn’t seem irrational in isolation, so let’s break it down part by part. From hereon out, please automatically prefix any declaration I make with “as of this writing.”</p>


<h3>Part 3: A unicorn pissing contest</h3>


<p>Let’s start from the end, since—tellingly—the actionable question was actually posed first.</p>


<p>There are a number of reasons our clients have not frequently hired our staff away. First, and most strictly, some contracts we sign have a two-way no-hire clause. In these cases, our clients cannot hire our employees and we cannot hire theirs. However, just because the contract does not forbid poaching does not make it a good idea. Our preferred engagement model is a long-term, cooperative and collaborative relationship; if either side starts yanking the other entity’s employees, that’s a great way to either poison the engagement.</p>


<p>In addition to all of this, however, there is sustainability at stake. As global consultancies go, nilenso is very small and very good. The author of the email is our 20th co-op member. Unless a client is very comfortable burning bridges, hiring two of our staff today trims our numbers by a non-trivial 10%. We don’t work with cannibal business owners.</p>


<p>That isn’t to say no one has ever left nilenso this way. If it happens, we simply hope that person takes their decision very seriously. Some of our alumni left to join past clients — and we wished them well.</p>


<p>People do not work at nilenso to get rich.</p>


<p>People work here because they believe in something. As we’ll see, “something” isn’t defined by some manifesto or mission statement. The “something” isn’t likely to be found elsewhere and it’s even less likely to be the same for two different people at nilenso. “Something” probably isn’t a single thing within the mind of a single person. “Something” is fractured and ever-changing. Each fractured shard is at any given time either a hallucination manifesting in action or a miscalculation fading to black.</p>


<p>As complex as The Somethings are, there has thus far been a few consistent threads. One? T<strong>echnical excellence</strong>. A potential client from Vietnam recently asked “<em>what is the ratio of fresh grads you hire to senior developers?</em>” Though it may not appear so on the surface, the idea that “<em>I’ll have a very hard [time] convincing [people I know from college] to join</em>” stems from the very same misconception.</p>


<p>nilenso is not a leveraged consultancy.</p>


<p>The misconception is that nilenso desires to behave as other consultancies by “leveraging”** their weakest employees (read: fresh grads) and charging the highest possible rate by inflating them with as few “senior”** developers as possible. The misconception is not unfounded. Most consultancies operate this way. We do not.</p>


<p>**<em> industry terminology, not mine</em></p>


<p>Convincing college grads to apply to nilenso is not a problem we’d like to solve. We have college grads begging us for internships and offering to work for free.</p>


<p><strong>We do not want to hire college grads.</strong></p>


<p>When our clients hire nilenso, we don’t want them satisfied. <em>We want them elated</em>. With one or two exceptions, our most junior developers always have multiple years of experience. They joined us because they couldn’t find their Something anywhere else in the industry. Not only has a college grad not, by definition, owned her own software in production — she hasn’t had an opportunity to go look for Something yet. <em>Go searching first—and learn to build and deploy software while you’re at it. </em>Maybe she’ll find her Something. If she doesn’t, she can join a company like ours.</p>


<p>We are not Uber or Goldman Sachs. We don’t <a href="https://en.wikipedia.org/wiki/Uber#Sexual_harassment_allegations_and_management_shakeup_(2017)">treat our female colleagues like shit</a>, we don’t have an <a href="https://en.wikipedia.org/wiki/Uber#Workplace_culture">“asshole culture”</a>, we haven’t <a href="https://en.wikipedia.org/wiki/Uber#2014_reviews_by_the_Better_Business_Bureau">received a failing grade from the Better Business Bureau</a>, nor do we have a list of “controversies and legal issues” <a href="https://en.wikipedia.org/wiki/Goldman_Sachs#Controversies_and_legal_issues">as long as your arm</a>.</p>


<p>Some of us have worked for companies like these and we have done everything in our power to <em>prevent</em> nilenso from becoming such a company. We don’t need revenue in the billions to behave this way but racing to compete salaries with such companies does us zero favours in that arena.</p>


<p>There is perhaps no better way for a college kid to learn the value of a company like nilenso than to experience a cesspool like Uber firsthand for a couple years. Not that I recommend the grads start their search there, mind you.</p>


<h3>Part 2: Where is all this magical money coming from?</h3>


<p>In “Part 3”, when I say that nilenso is “very small and very good” I mean that from the bottom of my heart. We are <em>very</em> good. We don’t fantasize about our clients paying us $100/hour — our current clients pay us this because we are <em>worth it</em>. Our first month with every new client is always evaluatory (we even did a 3-month evaluation period once). This is an opportunity for our clients to fire us if they find us too expensive and for us to fire them if we find the relationship isn’t productive.</p>


<p>Why are our developers worth well over $10,000 USD per month?</p>


<p>There is a watermark here. One can calculate the watermark in a number of ways. The first and most obvious is: How many people at nilenso have ever been paid $120,000/year or higher in any country? <strong>Two.</strong> So that probably puts the watermark too high. How many people at nilenso could be paid $120,000/year (roughly 77 lakh rupees) today — specifically in Bangalore? <strong>Three.</strong></p>


<p>These numbers are clearly too low. The entire value of our company does not hinge on two or three people. But these are the only objective numbers we have on this axis. If we wanted to reach for a subjective number, we could say the watermark exists beneath anyone to whom our rates can be actively attributed. I would say these people number <strong>seven</strong>.</p>


<p>Seven of twenty active knowledge workers does not mean we “leverage” (ugh, that word) the other thirteen. Other folks are very close or arguably cross this watermark. But every team has a natural pecking order (a hierarchy drawn in a straight line, whether you draw it with a pen or with your mind) and wherever we assume this watermark to be, our value to our customers is more than the sum of the parts.</p>


<p>The flaw in the “wow, we make so much money!” argument is that no matter where you place this watermark, you must actively acknowledge from where this value is generated: above the watermark. If there is an argument to be made for altering the salary curve to reflect this, that alteration always implies an inflection point <em>at the watermark</em>. People above the watermark should be paid more. People below the watermark should be paid less. Your financial goals as an employee of such a company are dictated by your ability to cross the watermark and stay above it.</p>


<p>That doesn’t sound like a place I’d like to work.</p>


<p>I’m guessing the author of the original email feels the same way. Being our most junior staff member means starting at the very bottom of this curve and a search for the source of a consultancy’s value is always upward-facing. That’s a big hill to climb and it’s a lot more likely that crossing the watermark will involve nilenso growing from 20 to 40 rather than the most junior employee leapfrogging over 10 other people. We grow slowly on purpose — and it’s not to keep junior people at the bottom of the pay scale.</p>


<p>We would rather grow <em>inside</em>. We want our most junior staff to become more senior not by stacking themselves on top of new junior people but by perfecting their execution.</p>


<blockquote>[F]or people with more experience and established reputation, there is an incentive to break away and start their own business so that they can pocket the difference.</blockquote>


<p>No one at nilenso has ever done this. Why not?</p>


<h3>Part 1: Where does all this money go?</h3>


<p>Now we get to the juicy bits. The interesting question is not “how much can we pay?” <em>at all</em>. If someone wants to double her salary she can very easily do so today and nilenso is entirely unequipped to deal with that except to wish her the best with her new job.</p>


<p><strong>People do not work at nilenso to get rich.</strong></p>


<p>People work at nilenso to find… something. Something. What is that Something? To answer this, we must ask: What is nilenso? This is the interesting question.</p>


<p>Nilenso Software LLP is, today, a co-op; nilenso is self-hosted. It is written in a homoiconic language. It is self-referential. It is self-describing. The specification is the paper the specification is written on. And while none of these qualities are the Something we were all after, they are the qualities which equip us to do <em>anything we want</em> with the company. We are uninhibited in finding our Somethings if we never need to beg for VC money, never need to give up control, and never need to grow before we’re ready.</p>


<p>“Anything we want” can include bumping our salaries by 10% or 50%. It can include handing out bonuses. It can include democratically deciding we want to execute across-the-board pay cuts. But these are all pretty boring axes to manipulate the business. You don’t have to work at a co-op (and therefore run it) for very long to realize the the classic definitions of success are mind-numbingly boring… albeit always tempting.</p>


<p>Anything we want? Here is a far more interesting list:</p>


<ul><li>helping parents raise children in the modern world</li><li>protect privacy as a fundamental right</li><li>fuel our office with solar panels</li><li>make the activity of building free software a work of pride, again</li><li>liberate the data sciences with truly open data</li><li>globally redefine what constitutes a “normal workplace”</li><li>what do you want to do? does it take money to do it? (hint: yes)</li></ul>


<p>Every rupee we keep inside nilenso, invest as nilenso, or spend as nilenso pushes us further toward a collective activity, a collective vision. Every rupee we divide and distribute, 5 paise per co-op member, is a step away from a collective vision. The farthest we can go in this direction is to distribute everything: nilenso saves nothing, invests nothing, and builds nothing. Well before that stage, nilenso becomes an Umbrella Consultancy and we are nilenso in name only… another army of contractors with a brand attached and a few rupees saved every month to pay the water bill.</p>


<p>It is entirely valid for the collective vision of nilenso to be “we don’t want to have a collective vision” but once that is decided, there is no going back. If you want to become a software product company (as we attempted with <a href="https://relay-chat.com">Relay</a> and previously attempted with <a href="https://github.com/nilenso/kulu">Kulu</a>), an electric rickshaw taxi service (a business model we have seriously considered), or a cafe (a business model we have jokingly considered)… you can’t. You get to go back to Square One, where we were when we incorporated nilenso in 2013. But you get to go back with no money and no way to compete on salaries but to rebuild a vision from scratch.</p>


<p>Good luck. It wasn’t easy the first time.</p>


<h3>Epilogue</h3>


<p>There is no easy way to think about the future regarding corporate or personal finances and arrive at novel conclusions. Follow Steve Jobs’ advice, drop enough acid, and you may. But you are still unlikely to execute based on these conclusions when you are sober on Monday. Such contemplations demand an entire suite of thought exercises. This is my favourite:</p>


<p>Flip the <em>Five Whys</em> exercise around and you have the <em>And Then What?</em> exercise.</p>


<p>Once you are rich, then what? Once you have solved the original problem, then what? Once you have solved an entire category of problems, then what? Once you have taught others to do it, then what?</p>


<p>And then what?</p>


<p>And then what?</p>


<p><img src="https://medium.com/_/stat?event=post.clientViewed&referrerSource=full_rss&postId=a18a2976f0d7" width="1" height="1"><div class="author">
  <img src="http://nilenso.com/images/people/steven-200.png" style="width: 96px; height: 96;">
  <span style="position: absolute; padding: 32px 15px;">
    <i>Original post by <a href="http://twitter.com/deobald">Steven Deobald</a> - check out <a href="https://medium.com/@deobald?source=rss-f6b24d2dc678------2">Stories by Steven Deobald on Medium</a></i>
  </span>
</div></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
  
    
      <h1 class="entry-title"><a href="/blog/2018/04/09/designing-for-open-source-software/">Designing for Open Source Software</a></h1>
      
      
    
      <p class="meta">
        









<time datetime="2018-04-09T00:00:00+05:30" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h4>Mattermost → Relay</h4>


<p>When you hear the words “open source” attached to a product, what image comes to mind? Do you imagine an office full of designers obsessing over every little pixel? Or do you imagine an army of alpha-nerds piecing together a slap-dash knockoff of some proprietary software?</p>


<p>We all believe open source software is badly designed because, historically, it was. (#NotAllOpenSourceSoftware)</p>


<p>Thirty years ago, in 1988, the very concept of a license or design language for software was far beyond the average person. A decade later, everything was still awful. Software barely worked. Your PC definitely had a virus on it. HTML had a &lt;blink&gt; tag. Installing Linux required weeks of patience and belief in oneself — the kind of conviction I would need to train for a marathon. If there is one canonical failure we can promote as the poster child of this dark era, it is OpenOffice. Or StarOffice or LibreOffice or Apache OpenOffice or OOo or AOO or whatever name you might know it by. When the very <em>name</em> of the product is this broken it’s unlikely to succeed as a brand.</p>


<p>Fast forward ten more years. As of 2008, Firefox was eating Microsoft’s lunch. Firefox was open source, fast, and standards-compliant. It was easy to like Firefox. But we didn’t like Firefox. We <strong>loved</strong> Firefox. Firefox had a brand before it was Firefox. A brand isn’t a snappy name and a cute logo. Your product is your brand and your product is dictated by its design.</p>


<p><figure><img alt="" src="https://cdn-images-1.medium.com/max/400/1*Mbzpzkw4uraKcHuYgVnp_g.png" /><figcaption>Image from <a href="http://www.lowter.com/blogs/2008/6/21/firefox-3">Lowter</a></figcaption></figure><p>In 2018, user expectations demand that design asymptotically approach perfection: your product better be open, compatible, clean, fast, and powerful. When nilenso first made the move <a href="https://medium.com/@deobald/we-created-relay-by-escaping-slack-aedf0579a65f">from Slack to Mattermost</a>, we kept all of this in mind. From our very first deployment of Mattermost it felt <em>whole</em>. We chose Mattermost because it was so very close to the design we wanted, we knew we could help bring it the rest of the way.</p><h3>The beginning</h3><p>The design problems that currently exist with Mattermost aren’t just visual but interaction and experience related. One of the first issues we took up was adding infinite scroll to the channel history. We couldn’t fathom why users should manually click to load every page of history. <a href="https://github.com/mattermost/mattermost-webapp/pull/941">So we fixed it</a>!</p><p>In the not-too-distant future we will add all the little nuanced details which transform Relay into software you absolutely <strong>love</strong>. At the moment, however, our aim is to solve the obvious problems our users have with the Mattermost/Relay experience. Like infinite scroll, these are the problems that left our early users shouting at us “ugh… how have you not fixed this yet?!”</p><p>Such problems stem from the pains caused by inconsistencies and visual discrepancies which hamper usability. It is surprising to many how quickly these seemingly small issues amount to death by a thousand papercuts. It is equally surprising how quickly software becomes a joy to use once you get the basics right.</p><p>We’ll start with the basics — icons and fonts — and then move on to the specifics of how we redesigned Mattermost as Relay, piece by piece.</p><h3>Icons</h3><p><a href="https://medium.com/@deobald/we-created-relay-by-escaping-slack-aedf0579a65f">When we moved from Slack to Mattermost</a> the difference in icons used was stark. All icons used in Mattermost were inconsistent with respect to weights. They were standing out of the interface rather than blending in.</p><p>After further digging, we realised that Mattermost uses the free version of <a href="https://fontawesome.com/icons">Font Awesome</a>. Don’t get me wrong, I love the guys at Font Awesome; I even backed their kickstarter. But not all icons being available in the free weights (regular &amp; solid) is quite a bummer.</p><p>We had three rules for selecting an icon set:</p><ul><li>Icons <strong>must</strong> be open source</li><li>Icons need to be extensive</li><li>Icons need to be available in different styles (line and solid)</li></ul><blockquote>Allow me to interrupt with an aside. Technically, it is <em>possible</em> for us to build commercial artefacts into the Relay client by keeping them out of the source tree, even though Relay is AGPL3-licensed (as a derivative of the <a href="https://github.com/mattermost/mattermost-webapp">mattermost-webapp</a>). Why, then, do we feel it is essential that the icons be open source? Relay lives at the intersection of <a href="https://www.fsf.org/about/what-is-free-software">the principles of Free Software</a> and <a href="https://opensource.org/licenses/AGPL-3.0">the license which governs it</a>. Relay stands on the shoulders of giants — not only the Mattermost source code but Linux, GoLang, React, and hundreds of other projects. Here, between the spirit and the letter of Open Philosophies, exists a great deal of nuance. Cutting through this nuance is a root concept, however: “share alike.” If we take something from the free/open software community, what we return to that community should afford the next recipient the same freedoms we had. If we tweak Relay’s design until it is absolutely perfect but that involves changes which Mattermost cannot absorb upstream, we have failed them and every other project we have built ourselves upon. Thus, our icons must have an open license. — Steven Deobald</blockquote><p>Thanks Steve. Keeping the above mentioned points in mind, there were three icon sets that made the final round of discussion:</p><ul><li><a href="https://vmware.github.io/clarity/icons/icon-sets">Clarity icons</a></li><li><a href="https://feathericons.com/">Feather icons</a></li><li><a href="https://useiconic.com/open">Iconic icons</a></li></ul><p>We chose the Clarity icon set because of styles, consistency, and the icons being part of a design language system. Clarity is an open source design system created and maintained by the good folks at VMware. Since VMware has a dedicated team pushing continuous updates there is little fear the icon set will be abandoned or go stale.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*8YedTvLmvirplj0sFZ8_EA.png" /></figure><h3>Font</h3><p>Our font selection followed the same rules:</p><ul><li>Fonts <strong>must</strong> be open source</li><li>Fonts should be available in multiple weights</li></ul><p>…along with these additions:</p><ul><li>Fonts with large x-height for easy readability</li><li>Fonts with thick Regular weight so fonts will be crisp</li></ul><p>We stress so much on font weights because Relay is, first and foremost, a messaging tool. In Relay, you spend most of your time reading and we want this experience to be as enjoyable as possible. Relay also has complete Markdown support and weights help establish hierarchy both within the app and within the messages themselves.</p><p>We had a few contenders which satisfied these requirements. PT Sans, Lato, and Noto Sans all have an enjoyable reading experience but after a lot of trial and error we chose Fira Sans.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*zKRXBmPhm29XOuEAIu-V1Q.png" /></figure><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*cFZx7FuOzEfaRXvzkL9-3w.png" /></figure><p>Fira Sans is an incredible font. It has a healthy variety of weights and the compressed nature of the font holds the messaging interface together while keeping it crisp.</p><blockquote>Did you know that Fira Sans was built on top of Erik Spiekermann’s commercial font FF Meta? And that Spiekermann was commissioned by the Mozilla Foundation! <a href="http://typographica.org/typeface-reviews/fira-sans/">Read the whole story here</a></blockquote><h3>How Mattermost became Relay</h3><p>Implementing the design basics improved the existing experience. But to make those changes truly delightful we need to fine-tune every aspect of the app. We have started with three major sections:</p><ol><li>Left sidebar</li><li>Channel header</li><li>Main messaging interface</li></ol><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*Nxo6ha36AGdYC5yTbPM-4g.png" /><figcaption>Present Mattermost interface</figcaption></figure><h4>1. Left sidebar</h4><p>The sidebar’s Team section allows users to switch between teams within organisations that they’re a part of. The current Mattermost implementation truncates the team name and adds a byline. The problem with this is that it does not add any value since hovering over the team opens a tooltip with the team name anyway. We removed the byline and the truncated text.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*9SkvIpcpCoZcPqK_aQyg3w.png" /></figure><p>The sidebar’s Channel section felt mashed together. There is a clear hierarchy intended, which includes channel headers such as “Favorite Channels” and a distinction between active and inactive channels. We brought this hierarchy to the surface. Active channels have a heavy weight and inactive channels fade away with a lower opacity, despite the <em>increased</em> crispness of Fira Sans.</p><p>Grouped channels now have tighter spacing and groups themselves have larger spacing, allowing group titles to have a smaller font. All together, this makes the hierarchy obvious even at a glance.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*hiZL-Z9BvrCqgQmi1KZL3w.png" /></figure><h4>2. Channel header</h4><p>In the channel header we cleaned up the icons. Here are the issues we encountered with the icons:</p><ul><li>Most icons weren’t of the same weight</li><li>Some icons were of a different size</li><li>Some icons had some positioning overrides to align them</li></ul><p>The old icons for the channel header stood out, drawing attention away from the main chat area. We wanted them instead to blend into the design — unobtrusive but still obvious. To do this we removed the borders and switched the icon set to Clarity.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*JPH74EFnVALhnJT40VyJEQ.png" /></figure><p>In addition to icons, we fixed the CSS for the header and right sidebar, getting rid of all funny margins and relative positioning. We also added consistent heights, paddings, and sizes for each of the icons. These fixes don’t just add polish to the UI; once merged, they will also ensure it is easier for anyone in the community, including us, to customise Mattermost.</p><h4>3. Messaging interface</h4><p>The messaging interface is where users spend the most time. The messaging interface is also where Mattermost has most of its design inconsistencies, which are most glaring in the basics: alignment, spacing between posts, font size, and other elements on the interface such as the reply box.</p><p>After we moved to Fira Sans we bumped up the font size, made sure the headings and names are bolded to establish hierarchy, and fixed alignment and spacing issues to deliver a crisper and more enjoyable reading experience.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*fHEbMdPuBuTKZTOBIFOrLg.png" /></figure><h3>Themes</h3><p>Accessibility matters. We have light-sensitive coworkers and we’re sure you do, too. That’s why Relay comes with light and dark themes out of the box.</p><p>There are many Relay/Mattermost-compatible themes available already but we will pour all our energy into these two. They already make Relay beautiful and with every <a href="https://en.wikipedia.org/wiki/Kaizen">kaizen</a> they will only get better.</p><p>Of course, we don’t restrict you to these two themes. Relay also comes with community themes and Relay’s entire colour scheme is fully customisable… not just the sidebar (<em>cough</em> Slack <em>cough</em>). We are working to make Relay <a href="https://trello.com/c/rAjOFRmw">100% customisable through CSS</a> so users have complete control over every aspect of the UI, if they want.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*Xi8y7fGywOWfNpZPAYbxPA.png" /></figure><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*RSYA2D6Mbd-RgxbbYPcANQ.png" /></figure><h3>Putting it all together</h3><p>By following a consistent design language for icons, font, and themes we ensure all our “pieces” are whole unto themselves. Putting them back together, the application itself becomes whole.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*w6L79VGBNKJy4pKu-qhK1A.png" /></figure><p>Mattermost has published a <a href="https://github.com/mattermost/mattermost-server/issues/8350">design challenge</a> that encourages designers from all over the world to improve Mattermost (and, hence, Relay) readability and usability. <a href="https://github.com/mattermost/mattermost-webapp/pull/971">Our redesign addresses this challenge</a>.</p><p><a href="https://relay-chat.com/signup">Sign up</a>, try the redesign, and tell us what you think!</p><p>Along with visual design changes, Relay also aims to significantly improve its user experience. Our <a href="https://trello.com/b/OaHPWOAi">public Trello board</a> contains our plan for Relay’s future.</p><h3>Future</h3><p>“Design” is the <a href="https://medium.com/@baditaflorin/inside-the-top-1000-tags-on-medium-com-part-1-a1ff96356639">8th most popular tag on Medium</a>. “Open Source” is ranked 290. Source code licenses will never be sexy for the same reason your city’s water utility company will never be. The water supply is inherently a part of your city’s design. Similarly, your freedom as a user is designed into software you buy. Your ownership of a product is but one more limb in the tree of design.</p><blockquote>Open source software needs good design because good design respects you, the user.</blockquote><blockquote>❤</blockquote><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*g6rztkAO4PgkBPPYG0A91w.png" /><figcaption>Illustration by <a href="https://www.instagram.com/basementtaco/">Shrishti Ambani</a></figcaption></figure><img src="https://medium.com/_/stat?event=post.clientViewed&referrerSource=full_rss&postId=65ea40616c5a" width="1" height="1"><hr><p><a href="https://medium.com/the-relay/designing-for-open-source-software-65ea40616c5a">Designing for Open Source Software</a> was originally published in <a href="https://medium.com/the-relay">The Relay</a> on Medium, where people are continuing the conversation by highlighting and responding to this story.</p><div class="author">
  <img src="https://nilenso.com/images/people/varun-200.png" style="width: 96px; height: 96;">
  <span style="position: absolute; padding: 32px 15px;">
    <i>Original post by <a href="http://twitter.com/">Varun Pai</a> - check out <a href="https://medium.com/@irrational_pai?source=rss-3a83e65683fa------2">Stories by Varun Pai on Medium</a></i>
  </span>
</div></p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/3">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>About Me</h1>
  <p>A little something about me.</p>
</section>
Included file 'custom/asides/subscribe.html' not found in _includes directory<section>
  <h1>Popular Posts</h1>
  <ul id="recent_posts">
    
  </ul>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2019/02/01/india-has-a-three-body-problem/">India has a Three-Body Problem</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/08/13/fast-sudoku-solver-in-haskell-3-picking-the-right/">Fast Sudoku Solver in Haskell #3: Picking the Right Data Structures</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/07/11/fast-sudoku-solver-in-haskell-2-a-200x-faster-sol/">Fast Sudoku Solver in Haskell #2: A 200x Faster Solution</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/06/28/fast-sudoku-solver-in-haskell-1-a-simple-solution/">Fast Sudoku Solver in Haskell #1: A Simple Solution</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/05/23/finances-in-an-employee-owned-technology-co-opera/">Finances in an Employee-Owned Technology Co-operative</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/nilenso">@nilenso</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'nilenso',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section id="twitter">
  <h1 class="tweets">Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating...</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("nilenso", , );
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <p>Follow <a href="http://twitter.com/nilenso">@nilenso</a></p>
  
</section>





  
</aside>

    </div>
  </div>
  <div class="sidebar">
    <p class="sidebar-content">
      <a href="http://nilenso.com">nilenso</a> is an employee-owned software cooperative based out of Bangalore, India.
    </p>
    <p class="sidebar-content">
      We practice test driven development and continuous delivery, and love working with Clojure and Ruby on Rails.
    </p>
    <p class="sidebar-content">
      This blog is a showcase of our growth as a consultancy, a product company and generally curious beings.
      Get in touch with us at <a href="mailto:hello@nilenso.com">hello@nilenso.com</a>.
    </p>
  </div>
</body>
<div class="footer">
  <div class="section-content contact-info">
    <p class="contact-phone-number">
      <a class="contact-link email-link" href="mailto:hello@nilenso.com">hello@nilenso.com</a>
      <a class="contact-link contact-social-link" href="http://twitter.com/nilenso">@nilenso</a>
      <a class="contact-link contact-social-link" href="http://github.com/nilenso">github.com/nilenso</a>
      <a class="contact-link" href="tel:+918040937123">+91 80 4093 7123</a>
     </p>
    <p class="contact-address">Nilenso Software LLP, #105, 10th Cross, Indiranagar Stage 1, Bangalore, India, 560038</p>
  </div>
</div>









  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</html>
