<!doctype html>
<!--[if IEMobile 7]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!-->
<html class="no-js" lang="en">
  <!--<![endif]-->

  <head>
    <meta charset="utf-8" />
    <title>
      {% if page.title %}{{ page.title }} - {% endif %}{{ site.title }}
    </title>
    <meta name="author" content="{{ site.author }}" />

    {% capture description %}{% if page.description %}{{ page.description }}{% 
    else %}{{ content | raw_content }}{% endif %}{% endcapture %}
    {% assign page_description = description | strip_html | condense_spaces | truncate:150 %}
    <meta
      name="description"
      content="{{ page_description }}"
    />
    {% if page.keywords %}
    <meta name="keywords" content="{{ page.keywords }}" />
    {% endif %}

    <!-- http://t.co/dKP3o1e -->
    <meta name="HandheldFriendly" content="True" />
    <meta name="MobileOptimized" content="320" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1"
    />
    <meta name="apple-mobile-web-app-capable" content="yes" />

    {% capture canonical %}{% if page.post_url %}{{ page.post_url }}{% else %}{{
    site.url }}{% if site.permalink contains '.html' %}{{ page.url }}{% else
    %}{{ page.url | remove:'index.html' | strip_slash }}{% endif %}{% endif %}{%
    endcapture %}
    <link rel="canonical" href="{{ canonical }}" />
    {% assign og_manifest = site.data['og-images'] %}
    {% assign og_generated = nil %}
    {% if og_manifest and page.url %}
      {% assign og_generated = og_manifest[page.url] %}
    {% endif %}

    {% assign meta_image = page.og_image | default: og_generated | default: page.cover_image | default: page.image %}
    {% if meta_image %}
      {% if meta_image contains '://' %}
        {% assign meta_image_url = meta_image %}
      {% else %}
        {% assign meta_image_url = meta_image | prepend: site.url %}
      {% endif %}
    {% endif %}

    <meta property="og:type" content="{% if page.layout == 'post' %}article{% else %}website{% endif %}" />
    <meta property="og:site_name" content="{{ site.title }}" />
    <meta property="og:title" content="{{ page.title | default: site.title }}" />
    <meta property="og:description" content="{{ page_description }}" />
    <meta property="og:url" content="{{ canonical }}" />
    {% if meta_image_url %}
      <meta property="og:image" content="{{ meta_image_url }}" />
    {% endif %}

    {% assign twitter_card_type = meta_image_url | default: false %}
    <meta name="twitter:card" content="{% if twitter_card_type %}summary_large_image{% else %}summary{% endif %}" />
    {% if site.twitter_user %}
      <meta name="twitter:site" content="@{{ site.twitter_user }}" />
    {% endif %}
    <meta name="twitter:title" content="{{ page.title | default: site.title }}" />
    <meta name="twitter:description" content="{{ page_description }}" />
    {% if meta_image_url %}
      <meta name="twitter:image" content="{{ meta_image_url }}" />
    {% endif %}
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="/images/favicon/apple-touch-icon.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="/images/favicon/favicon-32x32.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="/images/favicon/favicon-16x16.png"
    />
    <link
      href="{{ site.subscribe_rss }}"
      rel="alternate"
      title="{{site.title}}"
      type="application/atom+xml"
    />
    <script src="{{ root_url }}/javascripts/modernizr-2.0.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script>
      !window.jQuery &&
        document.write(
          unescape(
            '%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E',
          ),
        );
    </script>

    <!-- Google fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&family=Fira+Mono:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="preload"
      href="/assets/fonts/charter_regular.woff2"
      as="font"
      type="font/woff2"
      crossorigin
    />

    <link
      rel="stylesheet"
      href="https://unpkg.com/tailwindcss@^2/dist/tailwind.min.css"
    />
    <link
      href="{{ root_url }}/stylesheets/pygmentize.css"
      media="screen, projection"
      rel="stylesheet"
      type="text/css"
    />
    <link
      href="{{ root_url }}/stylesheets/screen.css"
      media="screen, projection"
      rel="stylesheet"
      type="text/css"
    />

    {% include google_analytics.html %}
  </head>
</html>
